:root{
  --bg0:#f6f7f8;
  --bg1:#ffffff;
  --txt:#0f1115;
  --muted:rgba(15,17,21,.62);
  --hair:rgba(15,17,21,.10);

  --glass: rgba(255,255,255,.86);
  --shadow: 0 14px 34px rgba(0,0,0,.08);

  --radius: 22px;
  --lime: #d7ff00;
  --lime2:#b9ff00;

  --pad: 16px;
  --tabH: 76px;
  --safeTop: env(safe-area-inset-top, 0px);
  --safeBot: env(safe-area-inset-bottom, 0px);

  --patternOpacity: .18;
}

html[data-theme="dark"]{
  --bg0:#0b0c0f;
  --bg1:#0f1115;
  --txt:#f3f5f7;
  --muted:rgba(243,245,247,.68);
  --hair:rgba(243,245,247,.12);

  --glass: rgba(18,20,26,.72);
  --shadow: 0 18px 42px rgba(0,0,0,.55);

  --patternOpacity: .14;
}

*{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
html,body{
  margin:0;
  height:100%;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","SF Pro Text",system-ui,Segoe UI,Roboto,Arial;
  color:var(--txt);
  background: transparent;
  overflow-x:hidden;

  /* убирает дикие “черные подложки” при overscroll */
  overscroll-behavior-y: none;
}

html{ position: relative; }

/* ГРАДИЕНТ ФОНА */
html::before{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -2;
  pointer-events:none;
  background: linear-gradient(180deg, var(--bg0), var(--bg1));
}

/* ПАТТЕРН (включается классом html.pattern-on) */
html::after{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events:none;

  background-repeat: repeat;
  background-size: 220px 220px;

  opacity: 0;
  transition: opacity .22s ease, background-image .22s ease;
}
html.pattern-on::after{ opacity: var(--patternOpacity); }
html[data-theme="light"]::after{ background-image: url("pattern-light.png"); }
html[data-theme="dark"]::after { background-image: url("pattern-dark.png"); }

button,input{ font:inherit; color:inherit; }
button{ border:0; background:none; cursor:pointer; }

.glass{
  background: var(--glass);
  border: 1px solid var(--hair);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
}

/* APP */
.app{
  position: relative;
  z-index: 1;
  min-height: 100vh;
  padding: calc(var(--pad) + var(--safeTop)) var(--pad) calc(var(--pad) + var(--tabH) + var(--safeBot));
}

/* TOPBAR */
.topbar{
  position: sticky;
  top: 0;
  z-index: 20;

  height: clamp(68px, 9vh, 96px);
  padding: 10px 12px;

  display:flex;
  align-items:center;
  justify-content:flex-end;

  background: transparent;
}

.brandSlot{
  position: absolute;
  left: 50%;
  top: calc(10px + var(--safeTop));
  transform: translateX(-50%);
  width: min(92vw, 560px);
  height: 44px;
  pointer-events:none;
}

.appLogo{
  width: 100%;
  height: 100%;
  object-fit: contain;
  display:block;

  /* аккуратно крупно, без “scale(5)” */
  transform: scale(1.25);
  transform-origin: center;
  image-rendering: -webkit-optimize-contrast;
}

/* Theme button */
.topActions{
  display:flex;
  align-items:center;
  gap: 10px;
}

.iconBtn{
  width: 42px;
  height: 42px;
  border-radius: 16px;

  display:flex;
  align-items:center;
  justify-content:center;

  border: 1px solid var(--hair);
  background: rgba(255,255,255,.55);
  transition: transform .12s ease, background .18s ease;
}
html[data-theme="dark"] .iconBtn{
  background: rgba(255,255,255,.06);
}
.iconBtn:active{ transform: scale(.96); }
.iconBtn svg{ width: 18px; height: 18px; display:block; }

/* STAGE */
.stage{ margin-top: 12px; }
.page{
  display:flex;
  flex-direction:column;
  gap: 14px;
}
.page[hidden]{ display:none; }

/* HERO */
.hero{ padding:18px; position:relative; overflow:hidden; }
.heroGlow{
  position:absolute;
  inset:-60px -30px auto -30px;
  height:220px;
  background:
    radial-gradient(closest-side at 22% 45%, rgba(215,255,0,.46), transparent 60%),
    radial-gradient(closest-side at 78% 34%, rgba(0,122,255,.18), transparent 62%);
  filter: blur(18px);
  pointer-events:none;
}
.heroTop{ position:relative; }
.kicker{
  display:inline-flex;
  padding:6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.40);
  font-size:12px;
  opacity:.92;
}
html[data-theme="dark"] .kicker{ background: rgba(255,255,255,.06); }

.heroTitle{
  margin-top: 10px;
  font-weight: 900;
  font-size: 22px;
  letter-spacing: -.2px;
}
.heroSub{
  margin-top: 8px;
  font-size: 13px;
  color: var(--muted);
}

.ctaRow{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 14px;
}
.cta{
  display:flex;
  gap: 10px;
  align-items:center;
  padding: 12px 12px;
  border-radius: 18px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.35);
  transition: transform .12s ease;
}
html[data-theme="dark"] .cta{ background: rgba(255,255,255,.06); }
.cta:active{ transform: scale(.98); }
.cta.primary{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.ctaIco{ font-size:20px; }
.ctaTitle{ font-weight: 850; font-size: 13px; }
.ctaSub{ font-size: 11px; opacity:.66; margin-top:2px; }
.ctaText{ display:flex; flex-direction:column; align-items:flex-start; }

/* GRID TILES */
.grid{ display:flex; flex-direction:column; gap: 12px; }
.tile{
  padding: 14px;
  border-radius: 22px;
  display:flex;
  gap: 12px;
  align-items:center;
  text-align:left;
  transition: transform .12s ease;
}
.tile:active{ transform: scale(.985); }
.tileIco{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(255,255,255,.35);
  border:1px solid var(--hair);
  font-size: 18px;
}
html[data-theme="dark"] .tileIco{ background: rgba(255,255,255,.06); }
.tileTxt{ flex:1; }
.tileTitle{ font-weight: 900; letter-spacing:-.1px; }
.tileSub{ margin-top:2px; font-size:12px; color: var(--muted); }
.tileChevron{ font-size: 24px; opacity:.30; }

/* PAGE HEAD */
.pageHead{ display:flex; gap: 12px; align-items:flex-start; }
.backBtn{
  width: 42px;
  height: 42px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.35);
  display:flex; align-items:center; justify-content:center;
  font-size: 22px;
}
html[data-theme="dark"] .backBtn{ background: rgba(255,255,255,.06); }
.backBtn:active{ transform: scale(.96); }
.pageTitle{ font-weight: 950; font-size: 18px; letter-spacing:-.2px; }
.pageSub{ margin-top:2px; font-size: 12px; color: var(--muted); }

.sectionTitle{
  margin-top: 6px;
  font-weight: 900;
  letter-spacing: -.1px;
  opacity: .9;
}

/* SEARCH */
.searchBar{
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 12px 12px;
}
.searchIco{ opacity:.7; }
.searchInput{
  flex:1;
  border: 1px solid var(--hair);
  border-radius: 14px;
  padding: 10px 10px;
  background: rgba(255,255,255,.35);
  outline:none;
}
html[data-theme="dark"] .searchInput{ background: rgba(255,255,255,.06); }
.searchBtn{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
  font-weight: 900;
}
.searchBtn:active{ transform: scale(.98); }
.searchResult{
  display:flex;
  flex-direction:column;
  gap: 10px;
}

/* ORDERS */
.orders{ display:flex; flex-direction:column; gap: 10px; }
.order{ padding: 14px; display:flex; flex-direction:column; gap: 10px; }
.orderTop{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
.orderId{ font-weight: 950; letter-spacing:-.2px; }
.orderMeta{ margin-top:3px; font-size: 12px; color: var(--muted); }

.status{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-size: 12px;
}
html[data-theme="dark"] .status{ background: rgba(255,255,255,.06); }
.sDot{ width: 8px; height: 8px; border-radius: 999px; background: #ffcc00; }
.sDot.blue{ background: #0a84ff; }
.sDot.orange{ background: #ff9f0a; }
.sDot.green{ background: #34c759; }
.sDot.gray{ background: rgba(255,255,255,.55); }
.sDot.red{ background: #ff3b30; }

.orderBody{ display:flex; flex-direction:column; gap: 6px; }
.orderLine{ font-size: 13px; }
.orderLine span{ color: var(--muted); }

.orderBtnRow{ display:flex; gap: 10px; }
.smallBtn{
  flex:1;
  padding: 10px 12px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-weight: 900;
  font-size: 13px;
}
html[data-theme="dark"] .smallBtn{ background: rgba(255,255,255,.06); }
.smallBtn.primary{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.smallBtn:active{ transform: scale(.98); }

/* PRICE */
.priceTabs{
  display:flex;
  gap: 8px;
  padding: 10px;
  overflow:auto;
}
.priceTab{
  padding: 10px 12px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-weight: 900;
  white-space: nowrap;
}
html[data-theme="dark"] .priceTab{ background: rgba(255,255,255,.06); }
.priceTab.active{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.priceCard{ padding: 14px; }
.priceH{ font-weight: 950; letter-spacing:-.2px; }
.priceList{ list-style:none; padding:0; margin:10px 0 0; display:flex; flex-direction:column; gap: 10px; }
.priceList li{ display:flex; justify-content:space-between; gap: 12px; font-size: 13px; }
.priceList span{ color: var(--muted); }
.priceList b{ font-weight: 950; }

/* PROFILE */
.profile{ padding: 14px; }
.profileRow{ display:flex; gap: 12px; align-items:center; }
.avatarWrap{
  width: 56px;
  height: 56px;
  border-radius: 18px;
  overflow:hidden;
  border: 1px solid var(--hair);
  background: linear-gradient(180deg, rgba(215,255,0,.35), rgba(215,255,0,.10));
  display:flex; align-items:center; justify-content:center;
}
.avatarImg{ width:100%; height:100%; object-fit: cover; }
.avatarFallback{
  font-weight: 950;
  color:#0f1115;
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}
.profileMeta{ min-width:0; }
.profileName{ font-weight: 950; }
.profileHint{ font-size: 12px; color: var(--muted); margin-top: 4px; }

.settings{ padding: 14px; }
.settingsTitle{ font-weight: 950; letter-spacing:-.2px; margin-bottom: 10px; }
.settingRow{ display:flex; align-items:center; justify-content:space-between; gap: 12px; padding: 8px 0; }
.settingName{ font-weight: 900; }
.settingDesc{ font-size:12px; color: var(--muted); margin-top: 3px; }

/* iOS-like switch */
.switch{
  width: 46px;
  height: 28px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
  position: relative;
}
html[data-theme="dark"] .switch{ background: rgba(255,255,255,.06); }
.switch .knob{
  position:absolute;
  top:3px;
  left:3px;
  width:22px;
  height:22px;
  border-radius: 999px;
  background: rgba(255,255,255,.96);
  box-shadow: 0 8px 16px rgba(0,0,0,.12);
  transition: transform .18s cubic-bezier(.2,.9,.2,1);
}
.switch[aria-checked="true"]{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.switch[aria-checked="true"] .knob{ transform: translateX(18px); }

.supportBtn{
  width: 100%;
  padding: 14px;
  border-radius: 22px;
  text-align:center;
  font-weight: 950;
}
.supportBtn:active{ transform: scale(.99); }

/* TABBAR */
.tabbar{
  position: fixed;
  left: var(--pad);
  right: var(--pad);
  bottom: calc(var(--pad) + var(--safeBot));
  height: var(--tabH);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 10px;
  gap: 8px;
  z-index: 30;
}
.tab{
  flex:1;
  height: 56px;
  border-radius: 18px;
  border: 1px solid transparent;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap: 4px;
  opacity: .85;
  transition: transform .12s ease, opacity .12s ease;
}
.tab:active{ transform: scale(.98); }
.tab .tTxt{ font-size: 11px; }
.tab.active{
  opacity: 1;
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}

/* CHAT */
.chatFab{
  position: fixed;
  right: 18px;
  bottom: calc(var(--pad) + var(--tabH) + 18px + var(--safeBot));
  width: 56px;
  height: 56px;
  border-radius: 20px;
  background: linear-gradient(180deg, var(--lime), var(--lime2));
  color:#0f1115;
  font-size: 20px;
  box-shadow: 0 18px 42px rgba(215,255,0,.22);
  z-index: 40;
  display:flex; align-items:center; justify-content:center;
}
.chatFab:active{ transform: scale(.95); }
.chatFab.flash{ animation: flashPulse .6s ease; }
@keyframes flashPulse{
  0%{ transform: scale(1); box-shadow: 0 18px 42px rgba(215,255,0,.22); }
  50%{ transform: scale(1.06); box-shadow: 0 22px 60px rgba(215,255,0,.35); }
  100%{ transform: scale(1); box-shadow: 0 18px 42px rgba(215,255,0,.22); }
}
.chatFabDot{
  position:absolute;
  top:10px; right:10px;
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: #ff3b30;
  box-shadow: 0 0 0 6px rgba(255,59,48,.18);
}

.chat{ position: fixed; inset: 0; display:none; z-index: 70; }
.chat.show{ display:block; }
.chatBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}
.chatPanel{
  position:absolute;
  right: 14px;
  bottom: calc(var(--pad) + var(--tabH) + 18px + var(--safeBot));
  width: min(380px, calc(100vw - 28px));
  height: min(560px, calc(100vh - 180px));
  border-radius: 26px;
  overflow:hidden;
}
.chatHead{
  display:flex; align-items:center; justify-content:space-between;
  padding: 12px;
  border-bottom: 1px solid var(--hair);
}
.chatClose{
  width: 38px; height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
}
html[data-theme="dark"] .chatClose{ background: rgba(255,255,255,.06); }
.chatTitle{ font-weight: 950; }
.chatSub{ margin-top:2px; font-size: 12px; color: var(--muted); }

.chatBody{
  overflow:auto;
  padding: 12px;
  height: calc(100% - 56px - 40px - 62px);
  display:flex;
  flex-direction:column;
  gap: 10px;
}

.bubble{
  max-width: 88%;
  padding: 10px 12px;
  border-radius: 18px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-size: 13px;
  line-height: 1.3;
}
html[data-theme="dark"] .bubble{ background: rgba(255,255,255,.06); }
.bubble.bot{ align-self:flex-start; }
.bubble.me{
  align-self:flex-end;
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.20), rgba(215,255,0,.08));
}

.emojiRow{
  display:flex;
  gap: 6px;
  padding: 8px 12px;
  border-top: 1px solid var(--hair);
  border-bottom: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
}
html[data-theme="dark"] .emojiRow{ background: rgba(255,255,255,.06); }
.emojiBtn{
  width: 34px;
  height: 34px;
  border-radius: 12px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.28);
}
html[data-theme="dark"] .emojiBtn{ background: rgba(255,255,255,.06); }
.emojiBtn:active{ transform: scale(.96); }

.chatForm{
  padding: 12px;
  padding-bottom: calc(12px + var(--safeBot));
  display:flex;
  gap: 10px;
  border-top: 1px solid var(--hair);
}
.chatInput{
  flex:1;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
  outline:none;
}
html[data-theme="dark"] .chatInput{ background: rgba(255,255,255,.06); }
.chatSend{
  width: 46px;
  border-radius: 16px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
  font-weight: 950;
}
.chatSend:active{ transform: scale(.96); }

/* MODAL */
.modal{ position: fixed; inset:0; display:none; z-index: 80; }
.modal.show{ display:block; }
.modalBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}
.modalCard{
  position:absolute;
  left: var(--pad);
  right: var(--pad);
  bottom: calc(var(--pad) + var(--safeBot));
  border-radius: 26px;
  padding: 14px;
}
.modalClose{
  position:absolute;
  top:10px;
  right:10px;
  width: 38px;
  height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
}
html[data-theme="dark"] .modalClose{ background: rgba(255,255,255,.06); }

.modalH{ font-weight: 950; font-size: 16px; letter-spacing:-.2px; margin:2px 0 6px; }
.modalP{ font-size: 13px; color: var(--muted); margin:0 0 10px; }
.modalGrid{ display:flex; flex-direction:column; gap: 8px; }
.modalRow{ display:flex; justify-content:space-between; gap: 10px; font-size: 13px; }
.modalRow span{ color: var(--muted); }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{ transition:none !important; animation:none !important; }
}
