:root{
  --bg0:#f6f7f8;
  --bg1:#ffffff;
  --txt:#0f1115;
  --muted:rgba(15,17,21,.62);
  --hair:rgba(15,17,21,.10);

  --glass: rgba(255,255,255,.86);
  --shadow: 0 14px 34px rgba(0,0,0,.08);

  --radius: 22px;
  --lime: #d7ff00;
  --lime2:#b9ff00;

  --pad: 16px;
  --tabH: 76px;
  --headerH: 88px;

  --safeTop: env(safe-area-inset-top, 0px);
  --safeBot: env(safe-area-inset-bottom, 0px);

  --patternOpacity: .18;
}

html[data-theme="dark"]{
  --bg0:#0b0c0f;
  --bg1:#0f1115;
  --txt:#f3f5f7;
  --muted:rgba(243,245,247,.68);
  --hair:rgba(243,245,247,.12);

  --glass: rgba(18,20,26,.72);
  --shadow: 0 18px 42px rgba(0,0,0,.55);

  --patternOpacity: .14;
}

*{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
html,body{
  margin:0;
  height:100%;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","SF Pro Text",system-ui,Segoe UI,Roboto,Arial;
  color:var(--txt);
  background: transparent;
  overflow-x:hidden;
  overscroll-behavior-y: none;
}

html{ position: relative; }

/* gradient */
html::before{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -2;
  pointer-events:none;
  background: linear-gradient(180deg, var(--bg0), var(--bg1));
}

/* pattern */
html::after{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events:none;

  background-repeat: repeat;
  opacity: 0;
  transition: opacity .22s ease, background-image .22s ease, background-size .22s ease;
}

/* включение паттерна */
html.pattern-on::after{ opacity: var(--patternOpacity); }

/* разные изображения */
html[data-theme="light"]::after{ background-image: url("pattern-light.png"); background-size: 300px 300px; }
html[data-theme="dark"]::after { background-image: url("pattern-dark.png");  background-size: 300px 300px; }

button,input,select{ font:inherit; color:inherit; }
button{ border:0; background:none; cursor:pointer; }

.glass{
  background: var(--glass);
  border: 1px solid var(--hair);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
}

/* APP */
.app{
  position: relative;
  z-index: 1;
  min-height: 100vh;

  /* фикс: хедер фиксированный, поэтому резервируем место */
  padding: calc(var(--headerH) + var(--safeTop) + 8px) var(--pad)
           calc(var(--pad) + var(--tabH) + var(--safeBot));
}

/* FIXED HEADER */
.topbar{
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  z-index: 0;

  height: calc(var(--headerH) + var(--safeTop));
  padding-top: var(--safeTop);
  display:flex;
  align-items:center;
  justify-content:center;

  background: transparent;
  pointer-events:none;
}

.brandSlot{
  width: min(92vw, 560px);
  height: 44px;
  pointer-events:none;
  display:flex;
  align-items:center;
  justify-content:center;
}

.appLogo{
  width: 100%;
  height: 100%;
  object-fit: contain;
  display:block;
  transform: scale(5);
  transform-origin: center;
  image-rendering: -webkit-optimize-contrast;

  /* плавная прозрачность при прокрутке */
  opacity: 1;
  transition: opacity 220ms ease;
}

/* когда логотип “заходит под блоки” — делаем чуть прозрачнее */
body.logoBehind .appLogo{
  opacity: .55;
}

/* STAGE */
.stage{
  margin-top: 2px;
  /* чтобы нижняя панель вкладок никогда не прилипала к контенту */
  padding-bottom: calc(var(--tabH) + 22px + var(--safeBot));
}

.page{
  position: relative;
  display:flex;
  flex-direction:column;
  gap: 14px;
}

/* Лого-водяной знак на всех страницах (как на главной):
   чуть прозрачный и "заходит" под заголовки/карточки */
.page::before{
  content:"";
  position:absolute;
  left: 50%;
  top: -26px;
  transform: translateX(-50%);
  width: min(92vw, 560px);
  height: 220px;
  background: url('logo.png') center / contain no-repeat;
  opacity: .10;
  pointer-events:none;
  z-index: 0;
}
.page > *{ position: relative; z-index: 1; }
.page[hidden]{ display:none; }

/* HERO */
.hero{ padding:18px; position:relative; overflow:hidden; }
.heroGlow{
  display:none;
}
.heroTop{ position:relative; text-align:center; }
.kickerCenter{
  display:inline-flex;
  padding:6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.40);
  font-size:12px;
  opacity:.92;
}
html[data-theme="dark"] .kickerCenter{ background: rgba(255,255,255,.06); }

.heroTitleCenter{
  margin-top: 12px;
  font-weight: 900;
  font-size: 22px;
  letter-spacing: -.2px;
}
.heroSubCenter{
  margin-top: 10px;
  font-size: 13px;
  color: var(--muted);
}

.ctaRow{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 14px;
}
.cta{
  display:flex;
  gap: 10px;
  align-items:center;
  padding: 12px 12px;
  border-radius: 18px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.35);
  transition: transform .12s ease;
}
html[data-theme="dark"] .cta{ background: rgba(255,255,255,.06); }
.cta:active{ transform: scale(.98); }
.cta.primary{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.ctaIco{ font-size:20px; }
.ctaTitle{ font-weight: 850; font-size: 13px; }
.ctaSub{ font-size: 11px; opacity:.66; margin-top:2px; }
.ctaText{ display:flex; flex-direction:column; align-items:flex-start; }

/* GRID TILES */
.grid{ display:flex; flex-direction:column; gap: 12px; }
.tile{
  padding: 14px;
  border-radius: 22px;
  display:flex;
  gap: 12px;
  align-items:center;
  text-align:left;
  transition: transform .12s ease;
}
.tile:active{ transform: scale(.985); }
.tileIco{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  display:flex;
  align-items:center;
  justify-content:center;
  background: rgba(255,255,255,.35);
  border:1px solid var(--hair);
  font-size: 18px;
}
html[data-theme="dark"] .tileIco{ background: rgba(255,255,255,.06); }
.tileTxt{ flex:1; }
.tileTitle{ font-weight: 900; letter-spacing:-.1px; }
.tileSub{ margin-top:2px; font-size:12px; color: var(--muted); }
.tileChevron{ font-size: 24px; opacity:.30; }

/* PAGE HEAD */
.pageHead{ display:flex; gap: 12px; align-items:flex-start; }
.backBtn{
  width: 42px;
  height: 42px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.35);
  display:flex; align-items:center; justify-content:center;
  font-size: 22px;
}
html[data-theme="dark"] .backBtn{ background: rgba(255,255,255,.06); }
.backBtn:active{ transform: scale(.96); }
.pageTitle{ font-weight: 950; font-size: 18px; letter-spacing:-.2px; }
.pageSub{ margin-top:2px; font-size: 12px; color: var(--muted); }

.sectionTitle{
  margin-top: 6px;
  font-weight: 900;
  letter-spacing: -.1px;
  opacity: .9;
}

/* SEARCH */
.searchBar{
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 12px 12px;
}
.searchIco{ opacity:.7; }
.searchInput{
  flex:1;
  border: 1px solid var(--hair);
  border-radius: 14px;
  padding: 10px 10px;
  background: rgba(255,255,255,.35);
  outline:none;
}
html[data-theme="dark"] .searchInput{ background: rgba(255,255,255,.06); }
.searchBtn{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
  font-weight: 900;
}
.searchBtn:active{ transform: scale(.98); }
.searchResult{
  display:flex;
  flex-direction:column;
  gap: 10px;
}

/* ORDERS */
.orders{ display:flex; flex-direction:column; gap: 10px; }
.order{ padding: 14px; display:flex; flex-direction:column; gap: 10px; }
.orderTop{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
.orderId{ font-weight: 950; letter-spacing:-.2px; }
.orderMeta{ margin-top:3px; font-size: 12px; color: var(--muted); }

.status{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-size: 12px;
}
html[data-theme="dark"] .status{ background: rgba(255,255,255,.06); }
.sDot{ width: 8px; height: 8px; border-radius: 999px; background: #ffcc00; }
.sDot.blue{ background: #0a84ff; }
.sDot.orange{ background: #ff9f0a; }
.sDot.green{ background: #34c759; }
.sDot.gray{ background: rgba(255,255,255,.55); }
.sDot.red{ background: #ff3b30; }

.orderBody{ display:flex; flex-direction:column; gap: 6px; }
.orderLine{ font-size: 13px; }
.orderLine span{ color: var(--muted); }

/* PRICE */
.priceTabs{
  display:flex;
  gap: 8px;
  padding: 10px;
  overflow:auto;
}
.priceTab{
  padding: 10px 12px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-weight: 900;
  white-space: nowrap;
}
html[data-theme="dark"] .priceTab{ background: rgba(255,255,255,.06); }
.priceTab.active{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.priceCard{ padding: 14px; }
.priceH{ font-weight: 950; letter-spacing:-.2px; }
.priceList{ list-style:none; padding:0; margin:10px 0 0; display:flex; flex-direction:column; gap: 10px; }
.priceList li{ display:flex; justify-content:space-between; gap: 12px; font-size: 13px; }
.priceList span{ color: var(--muted); }
.priceList b{ font-weight: 950; }

/* PROFILE */
.profile{ padding: 14px; }
.profileRow{ display:flex; gap: 12px; align-items:center; }
.avatarWrap{
  width: 56px;
  height: 56px;
  border-radius: 18px;
  overflow:hidden;
  border: 1px solid var(--hair);
  background: linear-gradient(180deg, rgba(215,255,0,.35), rgba(215,255,0,.10));
  display:flex; align-items:center; justify-content:center;
}
.avatarImg{ width:100%; height:100%; object-fit: cover; }
.avatarFallback{
  font-weight: 950;
  color:#0f1115;
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}
.profileMeta{ min-width:0; }
.profileName{ font-weight: 950; }
.profileHint{ font-size: 12px; color: var(--muted); margin-top: 4px; }
.profileActions{ margin-top: 12px; }
.profileBtn{
  width:100%;
  padding: 12px 12px;
  border-radius: 18px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
  font-weight: 950;
}
.profileBtn:active{ transform: scale(.98); }

.settings{ padding: 14px; }
.settingsTitle{ font-weight: 950; letter-spacing:-.2px; margin-bottom: 10px; }
.settingRow{ display:flex; align-items:center; justify-content:space-between; gap: 12px; padding: 8px 0; }
.settingName{ font-weight: 900; }
.settingDesc{ font-size:12px; color: var(--muted); margin-top: 3px; }
.settingText{ min-width: 0; }

/* iOS-like switch */
.switch{
  width: 46px;
  height: 28px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
  position: relative;
}
html[data-theme="dark"] .switch{ background: rgba(255,255,255,.06); }
.switch .knob{
  position:absolute;
  top:3px;
  left:3px;
  width:22px;
  height:22px;
  border-radius: 999px;
  background: rgba(255,255,255,.96);
  box-shadow: 0 8px 16px rgba(0,0,0,.12);
  transition: transform .18s cubic-bezier(.2,.9,.2,1);
}
.switch[aria-checked="true"]{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.switch[aria-checked="true"] .knob{ transform: translateX(18px); }

/* THEME SWITCH (солнце/луна) — без подсветки "вкл" */
.themeSwitch{
  position: relative;
  width: 92px;
  height: 38px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 0 10px;
  overflow:hidden;
}
html[data-theme="dark"] .themeSwitch{ background: rgba(255,255,255,.06); }

.themeSwitch .themeIcon{
  font-size: 16px;
  line-height: 1;
  opacity: .9;
  z-index: 2;
}

.themeSwitch .themeKnob{
  position:absolute;
  top: 3px;
  left: 3px;
  width: 32px;
  height: 32px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.35);
  z-index: 1;
  transition: transform .18s ease;
}
html[data-theme="dark"] .themeSwitch .themeKnob{ background: rgba(255,255,255,.10); }

.themeSwitch[aria-checked="true"] .themeKnob{ transform: translateX(54px); }

.supportBtn{
  width: 100%;
  padding: 14px;
  border-radius: 22px;
  text-align:center;
  font-weight: 950;
}
.supportBtn:active{ transform: scale(.99); }

/* Чуть воздуха над нижними вкладками на странице профиля */
.page[data-page="profile"] .supportBtn{ margin-bottom: 10px; }

/* TABBAR */
.tabbar{
  position: fixed;
  left: var(--pad);
  right: var(--pad);
  bottom: calc(var(--pad) + var(--safeBot));
  height: var(--tabH);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 10px;
  gap: 8px;
  z-index: 60;
}
.tab{
  flex:1;
  height: 56px;
  border-radius: 18px;
  border: 1px solid transparent;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap: 4px;
  opacity: .85;
  transition: transform .12s ease, opacity .12s ease;
}
.tab:active{ transform: scale(.98); }
.tab .tTxt{ font-size: 11px; }
.tab.active{
  opacity: 1;
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}

/* CHAT */
.chatFab{
  position: fixed;
  right: 18px;
  bottom: calc(var(--pad) + var(--tabH) + 18px + var(--safeBot));
  width: 56px;
  height: 56px;
  border-radius: 20px;
  background: linear-gradient(180deg, var(--lime), var(--lime2));
  color:#0f1115;
  font-size: 20px;
  box-shadow: 0 18px 42px rgba(215,255,0,.22);
  z-index: 70;
  display:flex; align-items:center; justify-content:center;
}
.chatFab:active{ transform: scale(.95); }
.chatFab.flash{ animation: flashPulse .6s ease; }
@keyframes flashPulse{
  0%{ transform: scale(1); box-shadow: 0 18px 42px rgba(215,255,0,.22); }
  50%{ transform: scale(1.06); box-shadow: 0 22px 60px rgba(215,255,0,.35); }
  100%{ transform: scale(1); box-shadow: 0 18px 42px rgba(215,255,0,.22); }
}
.chatFabDot{
  position:absolute;
  top:10px; right:10px;
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: #ff3b30;
  box-shadow: 0 0 0 6px rgba(255,59,48,.18);
}

.chat{ position: fixed; inset: 0; display:none; z-index: 90; }
.chat.show{ display:block; }
.chatBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}

/* чат НЕ прозрачный */
.chatPanel{
  position:absolute;
  right: 14px;
  bottom: calc(var(--pad) + var(--tabH) + 18px + var(--safeBot));
  width: min(380px, calc(100vw - 28px));
  height: min(560px, calc(100vh - 200px));
  border-radius: 26px;
  overflow:hidden;

  background: var(--bg1);
  border: 1px solid var(--hair);
  box-shadow: var(--shadow);
}
html[data-theme="dark"] .chatPanel{ background: #0f1115; }

.chatHead{
  display:flex; align-items:center; justify-content:space-between;
  padding: 12px;
  border-bottom: 1px solid var(--hair);
}
.chatClose{
  width: 38px; height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
}
html[data-theme="dark"] .chatClose{ background: rgba(255,255,255,.06); }
.chatTitle{ font-weight: 950; }
.chatSub{ margin-top:2px; font-size: 12px; color: var(--muted); }

.chatBody{
  overflow:auto;
  padding: 12px;
  height: calc(100% - 56px - 70px); /* фикс обрезания: резерв под форму */
  display:flex;
  flex-direction:column;
  gap: 10px;
}

.bubble{
  max-width: 88%;
  padding: 10px 12px;
  border-radius: 18px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.22);
  font-size: 13px;
  line-height: 1.3;
}
html[data-theme="dark"] .bubble{ background: rgba(255,255,255,.06); }
.bubble.bot{ align-self:flex-start; }
.bubble.me{
  align-self:flex-end;
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.18), rgba(215,255,0,.06));
}

.chatForm{
  position:absolute;
  left:0; right:0; bottom:0;
  padding: 12px;
  padding-bottom: calc(12px + var(--safeBot));
  display:flex;
  gap: 10px;
  border-top: 1px solid var(--hair);
  background: var(--bg1);
}
html[data-theme="dark"] .chatForm{ background: #0f1115; }

.chatInput{
  flex:1;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  outline:none;
}
html[data-theme="dark"] .chatInput{ background: rgba(255,255,255,.06); }
.chatSend{
  width: 46px;
  border-radius: 16px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
  font-weight: 950;
}
.chatSend:active{ transform: scale(.96); }

/* MODAL (center, opaque) */
.modal{ position: fixed; inset:0; display:none; z-index: 100; }
.modal.show{ display:block; }
.modalBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}
.modalCard{
  position:absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(520px, calc(100vw - 28px));
  max-height: min(640px, calc(100vh - 120px));
  overflow:auto;

  border-radius: 26px;
  padding: 16px;

  background: var(--bg1);
  border: 1px solid var(--hair);
  box-shadow: var(--shadow);
}
html[data-theme="dark"] .modalCard{ background:#0f1115; }

.modalClose{
  position:absolute;
  top:10px;
  right:10px;
  width: 38px;
  height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
}
html[data-theme="dark"] .modalClose{ background: rgba(255,255,255,.06); }

.modalH{ font-weight: 950; font-size: 16px; letter-spacing:-.2px; margin:2px 0 6px; }
.modalP{ font-size: 13px; color: var(--muted); margin:0 0 10px; }
.modalGrid{ display:flex; flex-direction:column; gap: 10px; }
.modalRow{ display:flex; justify-content:space-between; gap: 10px; font-size: 13px; }
.modalRow span{ color: var(--muted); }

.modalRowCol span{ color: var(--muted); display:block; margin-bottom:8px; }

/* ---------------- REGISTRATION / PROFILE EDIT ---------------- */
.modalLock .modalBackdrop{ pointer-events:none; }

.seg{ display:flex; gap:8px; }
.segBtn{
  flex:1;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: var(--text);
  border-radius: 14px;
  padding: 10px 12px;
  font-weight: 800;
  font-size: 13px;
}
html[data-theme="light"] .segBtn{ border-color: rgba(0,0,0,.08); background: rgba(0,0,0,.03); }
.segBtn.active{ outline: 2px solid rgba(255,255,255,.24); }
html[data-theme="light"] .segBtn.active{ outline: 2px solid rgba(0,0,0,.12); }

.avatarPick{ display:grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
.avatarOpt{
  width: 100%;
  aspect-ratio: 1/1;
  border-radius: 16px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}
html[data-theme="light"] .avatarOpt{ border-color: rgba(0,0,0,.08); background: rgba(0,0,0,.03); }
.avatarOpt img{ width:100%; height:100%; object-fit:cover; display:block; }
.avatarOpt.active{ outline: 2px solid rgba(255,255,255,.24); }
html[data-theme="light"] .avatarOpt.active{ outline: 2px solid rgba(0,0,0,.12); }

.avatarUploadRow{ display:flex; align-items:center; gap: 10px; }
.avatarHint{ font-size: 12px; color: var(--muted); }

.formError{
  font-size: 13px;
  color: #ff8c8c;
  background: rgba(255, 80, 80, .10);
  border: 1px solid rgba(255, 80, 80, .25);
  padding: 10px 12px;
  border-radius: 14px;
}

.giftCode{
  font-weight: 950;
  letter-spacing: .6px;
  text-transform: uppercase;
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px dashed rgba(255,255,255,.22);
  text-align:center;
}
html[data-theme="light"] .giftCode{ border-color: rgba(0,0,0,.18); }
.phoneRow{ display:flex; gap:10px; align-items:center; }
.phoneInput{
  flex:1;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  outline:none;
}
html[data-theme="dark"] .phoneInput{ background: rgba(255,255,255,.06); }

.smallBtn{
  padding: 10px 12px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.22);
  font-weight: 950;
}
html[data-theme="dark"] .smallBtn{ background: rgba(255,255,255,.06); }
.smallBtn.primary{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.smallBtn:active{ transform: scale(.98); }

/* disabled-state (используем для регистрации) */
.smallBtn:disabled{
  opacity: .55;
  pointer-events: none;
}

/* Кнопка "Завершить регистрацию" — компактная и по центру */
#regSubmitBtn{
  align-self: center;
  width: auto;
  padding-left: 14px;
  padding-right: 14px;
}

.smallBtn.danger{
  border-color: rgba(255,59,48,.42);
  background: linear-gradient(180deg, rgba(255,80,80,.18), rgba(255,80,80,.08));
}

.rateStars{
  display:flex;
  gap: 10px;
  justify-content:center;
  margin-top: 8px;
}
.rateStar{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.22);
  font-size: 20px;
  line-height: 1;
  padding:0;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity: .65;
}
html[data-theme="dark"] .rateStar{ background: rgba(255,255,255,.06); }
.rateStar.on{ opacity: 1; }

/* SHEETS */
.sheet{ position: fixed; inset:0; display:none; z-index: 110; }
.sheet.show{ display:block; }
.sheetBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}
.sheetCard{
  position:absolute;
  left: var(--pad);
  right: var(--pad);
  bottom: calc(var(--pad) + var(--safeBot));
  border-radius: 26px;
  overflow:hidden;

  background: var(--bg1);
  border: 1px solid var(--hair);
  box-shadow: var(--shadow);
}
html[data-theme="dark"] .sheetCard{ background:#0f1115; }

.sheetHead{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 10px;
  padding: 14px;
  border-bottom: 1px solid var(--hair);
}
.sheetTitle{ font-weight: 950; }
.sheetSub{ margin-top:3px; font-size: 12px; color: var(--muted); }
.sheetClose{
  width: 38px; height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
}
html[data-theme="dark"] .sheetClose{ background: rgba(255,255,255,.06); }

.sheetBody{
  padding: 14px;
  display:flex;
  flex-direction:column;
  gap: 12px;
}

.fieldLabel{ font-size: 12px; color: var(--muted); margin-bottom: 6px; }
.fieldHint{
  font-size: 12px;
  color: var(--muted);
  opacity: .9;
  margin: -2px 0 8px;
  line-height: 1.25;
}

/* заметка в шторке (оценка по фото) */
.sheetNote{
  padding: 12px;
  margin-bottom: 12px;
}
.sheetNoteTitle{
  font-weight: 700;
  font-size: 13px;
  margin-bottom: 6px;
}
.sheetNoteText{
  font-size: 13px;
  line-height: 1.25;
}

/* предпросмотр заявки */
.estimatePreview{
  padding: 12px;
  margin: 12px 0;
}
.estimatePreviewTitle{
  font-weight: 700;
  font-size: 13px;
  margin-bottom: 8px;
}
.estimatePreviewRow{
  font-size: 13px;
  line-height: 1.25;
  margin: 4px 0;
}
.fieldInput, .fieldSelect{
  width: 100%;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  outline:none;
}
html[data-theme="dark"] .fieldInput,
html[data-theme="dark"] .fieldSelect{ background: rgba(255,255,255,.06); }

.sheetBtn{ justify-content:center; }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{ transition:none !important; animation:none !important; }
}

/* ====== ESTIMATE FLOW ====== */
.cta[disabled]{ opacity:.45; pointer-events:none; transform:none !important; }

.reveal{
  max-height:0;
  opacity:0;
  transform: translateY(-6px);
  overflow:hidden;
  transition: max-height .24s ease, opacity .24s ease, transform .24s ease;
}
.reveal.show{
  max-height:140px;
  opacity:1;
  transform: translateY(0);
}

.estimateAbout{ padding:12px; }
.estimateAboutTitle{ font-weight:900; font-size:13px; margin-bottom:6px; }
.estimateAboutText{ font-size:13px; line-height:1.25; }

.globalLoading{
  position: fixed;
  inset: 0;
  display: none;
  align-items:center;
  justify-content:center;
  z-index: 9999;
  background: rgba(0,0,0,.35);
  backdrop-filter: blur(4px);
}
.globalLoading.show{ display:flex; }
.globalLoadingCard{ padding:14px 16px; border-radius:18px; display:flex; gap:12px; align-items:center; }
.spinner{
  width:22px; height:22px; border-radius:50%;
  border:3px solid rgba(255,255,255,.35);
  border-top-color: rgba(255,255,255,.95);
  animation: spin .85s linear infinite;
}
@keyframes spin{ to{ transform: rotate(360deg);} }
.globalLoadingText{ font-size:13px; font-weight:800; }

/* Оценка по фото — отступ перед кнопкой и центр кнопки */
#estimateNextBtn{
  display: block;
  margin: 18px auto 0;      /* отступ сверху + центр */
  width: min(320px, 100%);  /* не во всю ширину, но адаптивно */
}

/* ===== Estimate page: STANDARD like other pages ===== */
.page[data-page="estimate"] .pageHead{
  display:flex;
  gap: 12px;
  align-items:flex-start;
  justify-content:flex-start;
  margin-bottom: 0;
}

.page[data-page="estimate"] .pageTitle{
  font-weight: 950;
  font-size: 18px;        /* как у других страниц */
  letter-spacing:-.2px;
  text-align: left;
}

.page[data-page="estimate"] .pageSub{
  margin-top:2px;
  font-size: 12px;        /* как у других страниц */
  color: var(--muted);
  text-align: left;
}

.page[data-page="estimate"] .estimateCard{
  padding: 14px;
  border-radius: 22px;
}

#estimateOtherWrap{
  margin-top: 10px;
}

/* На странице оценки скрываем табы и чат */
body.page-estimate .tabbar,
body.page-estimate #chatFab{
  display: none !important;
}

/* Модалка отправки фото — чуть больше и больше воздуха сверху */
#estimateSendModal .modalCard{
  width: min(420px, calc(100% - 28px));
  padding-top: 22px; /* крестик остаётся там же, но текст ниже — не липнет */
}

#estimateSendModal .modalH{
  margin-top: 6px;
}

.page[data-page="estimate"] .estimateCard{
  padding: 14px;
  border-radius: 22px;
}

/* отступ между появляющимся полем и следующим полем */
#estimateOtherWrap.show{
  margin-bottom: 12px;
}

#leaveEstimateModal .modalCard{
  width: min(440px, calc(100vw - 28px));
  padding-top: 22px; /* чтобы крестик не касался текста */
}
#leaveEstimateModal .modalH{ margin-top: 6px; }

.pulseDot{
  width:10px;
  height:10px;
  border-radius:999px;
  background:#34c759;
  box-shadow: 0 0 0 0 rgba(52,199,89,.45);
  animation: pulseGreen 1.2s ease-in-out infinite;
  margin-right: 6px;
}
@keyframes pulseGreen{
  0%{ box-shadow: 0 0 0 0 rgba(52,199,89,.45); transform: scale(1); }
  70%{ box-shadow: 0 0 0 10px rgba(52,199,89,0); transform: scale(1.05); }
  100%{ box-shadow: 0 0 0 0 rgba(52,199,89,0); transform: scale(1); }
}

/* карточка заявки в списке */
.peItem{
  padding: 14px;
  display:flex;
  flex-direction:column;
  gap: 10px;
}
.peTop{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 10px;
}
.peTitle{ font-weight: 950; letter-spacing:-.2px; }
.peMeta{ margin-top:3px; font-size: 12px; color: var(--muted); }

.peStatus{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-size: 12px;
  font-weight: 900;
}
html[data-theme="dark"] .peStatus{ background: rgba(255,255,255,.06); }

.peDot{ width:8px; height:8px; border-radius:999px; background:#ff9f0a; }
.peDot.waiting_media{ background:#ff9f0a; }
.peDot.waiting_admin{ background:#ff9f0a; }
.peDot.answered{ background:#34c759; }
.peDot.archived{ background: rgba(255,255,255,.55); }

.peBody{ font-size: 13px; color: var(--muted); line-height:1.25; }

/* --- Registration title --- */
.modalTitleReg{
  font-size: 22px;
  font-weight: 700;
  text-align: center;
}

/* --- TG icon button (phone) --- */
.tgIconBtn{
  display:flex;
  align-items:center;
  justify-content:center;
  width:40px;
  height:40px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  /* Цвет иконки должен зависеть от темы */
  color: var(--text);
}
.tgIconBtn svg{ opacity:.9; }
.tgIconBtn svg path{ fill: currentColor; }

/* --- City active: тем же цветом, что и кнопка primary (Оценка по фото) --- */
#regCitySeg .segBtn.active,
#profCitySeg .segBtn.active{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}

/* --- Registration submit: компактная кнопка по ширине текста и по центру --- */
#regSubmitBtn{
  align-self: center;
  width: auto;
  padding-left: 14px;
  padding-right: 14px;
}

/* --- Disabled buttons (регистрация неактивна, пока всё не заполнено) --- */
.smallBtn:disabled,
.cta:disabled{
  opacity: .55;
  pointer-events: none;
}

/* --- Field errors --- */
.inputError{
  border-color: rgba(255,59,48,.85) !important;
  box-shadow: 0 0 0 2px rgba(255,59,48,.25);
}
.segError{
  border-color: rgba(255,59,48,.85) !important;
  box-shadow: 0 0 0 2px rgba(255,59,48,.25);
}

/* --- Hint under phone --- */
.phoneHint{
  margin-top:6px;
  font-size:12px;
  opacity:.75;
  line-height:1.25;
}
