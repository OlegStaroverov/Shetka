:root{
  --bg0:#f6f7f8;
  --bg1:#ffffff;
  --txt:#0f1115;
  --muted:rgba(15,17,21,.62);
  --hair:rgba(15,17,21,.10);

  --glass: rgba(255,255,255,.86);
  --shadow: 0 14px 34px rgba(0,0,0,.08);

  --radius: 22px;

  --accent: var(--lime);
  --accent2: var(--lime2);
  
  --accentBorder: color-mix(in oklab, var(--accent) 55%, var(--hair));
  --accentBg: linear-gradient(
    180deg,
    color-mix(in oklab, var(--accent) 22%, transparent),
    color-mix(in oklab, var(--accent) 10%, transparent)
  );


  --lime: #d7ff00;
  --lime2:#b9ff00;

  --pad: 16px;
  --tabH: 76px;
  --headerH: 88px;

  /* Логотип в хедере */
  --logoSlotH: 44px;
  /* Отступ сверху над логотипом: увеличили, чтобы весь экран чуть “опустился” */
  --logoTopPad: calc(var(--logoSlotH) * 0.50);

  --safeTop: env(safe-area-inset-top, 0px);
  --safeBot: env(safe-area-inset-bottom, 0px);
  
  --vh: 100vh;


  --patternOpacity: .18;
  --patternSize: 340px;
  --patternImg: url("pattern-light.png");
}

html[data-theme="dark"]{
  --bg0:#0b0c0f;
  --bg1:#0f1115;
  --txt:#f3f5f7;
  --muted:rgba(243,245,247,.68);
  --hair:rgba(243,245,247,.12);
  
  --glass: rgba(18,20,26,.72);
  --shadow: 0 18px 42px rgba(0,0,0,.55);

  --patternOpacity: .14;
  --patternImg: url("pattern-dark.png");
}

*{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
img, svg, video, canvas{ max-width:100%; height:auto; }
iframe{ max-width:100%; display:block; }
html,body{
  margin:0;
  height:100%;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","SF Pro Text",system-ui,Segoe UI,Roboto,Arial;
  color:var(--txt);
  background: transparent;
  overflow-x:hidden;
  overscroll-behavior-y: none;
  -webkit-text-size-adjust: 100%;
}

/* Prevent accidental horizontal overflow from long text/flex children */
.glass, .page, .stage, .hero, .svcCard, .tile, .crItemCard, .modalCard{ min-width: 0; }
.svcTitle, .svcSub, .pageTitle, .pageSub, .crPreviewItemTitle, .crPreviewItemProblem{ overflow-wrap:anywhere; }

html{ position: relative; }

/* gradient */
html::before{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -2;
  pointer-events:none;
  background: linear-gradient(180deg, var(--bg0), var(--bg1));
}

/* pattern */
html::after{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events:none;

  background-repeat: repeat;
  opacity: 0;
  transition: opacity .22s ease, background-image .22s ease, background-size .22s ease;
}

/* включение паттерна */
html.pattern-on::after{ opacity: var(--patternOpacity); }

/* разные изображения + единый размер */
html::after{ background-image: var(--patternImg); background-size: var(--patternSize) var(--patternSize); }

/* Дополнительные 2 слоя паттерна (для более яркого эффекта, как 3 слоя) */
body::before,
body::after{
  content:"";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events:none;
  background-image: var(--patternImg);
  background-repeat: repeat;
  background-size: var(--patternSize) var(--patternSize);
  opacity: 0;
  transition: opacity .22s ease, background-image .22s ease, background-size .22s ease;
}

/* включение паттерна = включаем сразу все 3 слоя */
html.pattern-on body::before{ opacity: calc(var(--patternOpacity) * 0.55); background-position: 40px 20px; }
html.pattern-on body::after { opacity: calc(var(--patternOpacity) * 0.45); background-position: -30px 60px; }

button,input,select{ font:inherit; color:inherit; }
button{ border:0; background:none; cursor:pointer; }
button{
  -webkit-appearance: none;
  appearance: none;
  line-height: 1.2;
  touch-action: manipulation;
}
input,select{ line-height: 1.2; }

input[type="date"], input[type="time"]{
  max-width: 100%;
  min-width: 0;
}

.glass{
  background: var(--glass);
  border: 1px solid var(--hair);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
}

/* APP */
.app{
  position: relative;
  z-index: 1;
  min-height: var(--vh);

  /* Responsive: keep content readable on large screens */
  max-width: 560px;
  margin-left: auto;
  margin-right: auto;

  /* фикс: хедер фиксированный, поэтому резервируем место */
  padding: calc(var(--headerH) + var(--safeTop) + var(--logoTopPad) + 8px) var(--pad)
           calc(var(--pad) + var(--tabH) + var(--safeBot));
}

/* FIXED HEADER */
.topbar{
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  z-index: 0;

  height: calc(var(--headerH) + var(--safeTop) + var(--logoTopPad));
  padding-top: calc(var(--safeTop) + var(--logoTopPad));
  display:flex;
  align-items:center;
  justify-content:center;

  background: transparent;
  pointer-events:none;
}

.brandSlot{
  width: min(92vw, 560px);
  height: var(--logoSlotH);
  pointer-events:none;
  display:flex;
  align-items:center;
  justify-content:center;
}

.appLogo{
  width: 100%;
  height: 100%;
  object-fit: contain;
  display:block;
  transform: scale(5);
  transform-origin: center;
  image-rendering: -webkit-optimize-contrast;

  /* плавная прозрачность при прокрутке */
  opacity: 1;
  transition: opacity 220ms ease;
}

/* когда логотип “заходит под блоки” — делаем чуть прозрачнее */
body.logoBehind .appLogo{
  opacity: .10;
}

/* STAGE */
.stage{
  margin-top: 2px;
  /* чтобы нижняя панель вкладок никогда не прилипала к контенту */
  padding-bottom: calc(var(--tabH) + 22px + var(--safeBot));
}

.page{
  position: relative;
  display:flex;
  flex-direction:column;
  gap: 14px;
}

.page[hidden]{ display:none; }

/* HERO */
.hero{ padding:18px; position:relative; overflow: visible; }
.heroGlow{
  display:none;
}
.heroTop{ position:relative; text-align:center; }
.kickerCenter{
  display:inline-flex;
  padding:6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.40);
  font-size:12px;
  opacity:.92;
}
html[data-theme="dark"] .kickerCenter{ background: rgba(255,255,255,.06); }

.heroTitleCenter{
  margin-top: 12px;
  font-weight: 900;
  font-size: 22px;
  letter-spacing: -.2px;
}
.heroSubCenter{
  margin-top: 10px;
  font-size: 13px;
  color: var(--muted);
}

.ctaRow{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 14px;
}
.cta{
  display:flex;
  gap: 10px;
  align-items:center;
  padding: 12px 12px;
  border-radius: 18px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.35);
  transition: transform .12s ease;
}
html[data-theme="dark"] .cta{ background: rgba(255,255,255,.06); }
.cta:active{ transform: scale(.98); }
.cta.primary{
  border-color: var(--accentBorder);
  background: var(--accentBg);
}
/* ВАЖНО: "Оценка по фото" и "Вызвать курьера" должны быть одинаковыми в светлой/тёмной теме */
html[data-theme="dark"] .cta.primary{
  border-color: var(--accentBorder);
  background: var(--accentBg);
}
.ctaIco{ font-size:20px; }
.ctaTitle{ font-weight: 850; font-size: 13px; }
.ctaSub{ font-size: 11px; opacity:.66; margin-top:2px; }
.ctaText{ display:flex; flex-direction:column; align-items:flex-start; }

/* GRID TILES */
.grid{ display:flex; flex-direction:column; gap: 12px; }
.tile{
  padding: 14px;
  border-radius: 22px;
  display:flex;
  gap: 12px;
  align-items:center;
  text-align:left;
  transition: transform .12s ease;
}
.tile:active{ transform: scale(.985); }
.tileIco{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  display:flex;
  align-items:center;
  justify-content:center;

  border-color: var(--accentBorder);
  background: var(--accentBg);

  font-size: 18px;
}

.tileTxt{ flex:1; }
.tileTitle{ font-weight: 900; letter-spacing:-.1px; }
.tileSub{ margin-top:2px; font-size:12px; color: var(--muted); }
.tileChevron{ font-size: 24px; opacity:.30; }

/* PAGE HEAD */
.pageHead{ display:flex; gap: 12px; align-items:flex-start; }
.backBtn{
  width: 42px;
  height: 42px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.35);
  display:flex; align-items:center; justify-content:center;
  font-size: 22px;
}
html[data-theme="dark"] .backBtn{ background: rgba(255,255,255,.06); }
.backBtn:active{ transform: scale(.96); }
.pageTitle{ font-weight: 950; font-size: 18px; letter-spacing:-.2px; }
.pageSub{ margin-top:2px; font-size: 12px; color: var(--muted); }

/* чтобы заголовки не терялись на фоне логотипа */
.pageTitle,
.pageSub{
  text-shadow:
    0 1px 2px rgba(0,0,0,.28),
    0 0 10px rgba(255,255,255,.14);
}

html[data-theme="dark"] .pageTitle,
html[data-theme="dark"] .pageSub{
  text-shadow:
    0 1px 2px rgba(0,0,0,.55),
    0 0 10px rgba(0,0,0,.20);
}

.sectionTitle{
  margin-top: 6px;
  font-weight: 900;
  letter-spacing: -.1px;
  opacity: .9;
}

/* SEARCH */
.searchBar{
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 12px 12px;
}
.searchIco{ opacity:.7; }
.searchInput{
  flex:1;
  border: 1px solid var(--hair);
  border-radius: 14px;
  padding: 10px 10px;
  background: rgba(255,255,255,.35);
  outline:none;
}
html[data-theme="dark"] .searchInput{ background: rgba(255,255,255,.06); }
.searchBtn{
  padding: 10px 12px;
  border-radius: 14px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  border-color: var(--accentBorder);
  background: var(--accentBg);
  font-weight: 900;
}
.searchBtn:active{ transform: scale(.98); }
.searchResult{
  display:flex;
  flex-direction:column;
  gap: 10px;
}

/* ORDERS */
.orders{ display:flex; flex-direction:column; gap: 10px; }
.order{ padding: 14px; display:flex; flex-direction:column; gap: 10px; }
.orderTop{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
.orderId{ font-weight: 950; letter-spacing:-.2px; }
.orderMeta{ margin-top:3px; font-size: 12px; color: var(--muted); }

.status{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-size: 12px;
}
html[data-theme="dark"] .status{ background: rgba(255,255,255,.06); }
.sDot{ width: 8px; height: 8px; border-radius: 999px; background: #ffcc00; }
.sDot.blue{ background: #0a84ff; }
.sDot.orange{ background: #ff9f0a; }
.sDot.green{ background: #34c759; }
.sDot.gray{ background: rgba(255,255,255,.55); }
.sDot.red{ background: #ff3b30; }

.orderBody{ display:flex; flex-direction:column; gap: 6px; }
.orderLine{ font-size: 13px; }
.orderLine span{ color: var(--muted); }

/* PRICE */
.priceTabs{
  display:flex;
  gap: 8px;
  padding: 10px;
  overflow:auto;
}

/* Scrollbar: в светлой теме делаем темнее, чтобы было видно */
:where(.priceTabs, .modalCard){
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: rgba(15,17,21,.35) transparent;
}
html[data-theme="dark"] :where(.priceTabs, .modalCard){
  scrollbar-color: rgba(243,245,247,.25) transparent;
}
:where(.priceTabs, .modalCard)::-webkit-scrollbar{ width: 6px; height: 6px; }
:where(.priceTabs, .modalCard)::-webkit-scrollbar-track{ background: transparent; }
:where(.priceTabs, .modalCard)::-webkit-scrollbar-thumb{
  background: rgba(15,17,21,.35);
  border-radius: 999px;
}
html[data-theme="dark"] :where(.priceTabs, .modalCard)::-webkit-scrollbar-thumb{
  background: rgba(243,245,247,.25);
}

.priceTab{
  padding: 10px 12px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-weight: 900;
  white-space: nowrap;
}
html[data-theme="dark"] .priceTab{ background: rgba(255,255,255,.06); }
.priceTab.active{
  border-color: var(--accentBorder);
  background: var(--accentBg);
}

.priceCard{ padding: 14px; }
.priceH{ font-weight: 950; letter-spacing:-.2px; }
.priceList{ list-style:none; padding:0; margin:10px 0 0; display:flex; flex-direction:column; gap: 10px; }
.priceList li{ display:flex; justify-content:space-between; gap: 12px; font-size: 13px; }
.priceList span{ color: var(--muted); }
.priceList b{ font-weight: 950; }

/* PROFILE */
.profile{ padding: 14px; }
.profileRow{ display:flex; gap: 12px; align-items:flex-start; }
.avatarWrap{
  width: 76px;
  height: 76px;
  border-radius: 18px;
  overflow:hidden;
  border: 0;
  background: transparent;
  display:flex;
  align-items:center;
  justify-content:center;
}
.avatarImg{ width:100%; height:100%; object-fit: cover; }
.profileMeta{ min-width:0; }
.profileName{ font-weight: 950; }
.profileHint{ font-size: 12px; color: var(--muted); margin-top: 4px; }
.profileQuickBtns{ margin-top: 10px; display:flex; flex-direction:column; gap: 10px; }
.profileActions{ margin-top: 12px; }
.profileBtn{
  width:100%;
  padding: 12px 12px;
  border-radius: 18px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  border-color: var(--accentBorder);
  background: var(--accentBg);
  font-weight: 950;
}
.profileBtn:active{ transform: scale(.98); }

/* Кнопка "Написать в поддержку" — как "Настройки профиля" */
.supportBtn{
  width:100%;
  padding: 12px 12px;
  border-radius: 18px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  border-color: var(--accentBorder);
  background: var(--accentBg);
  font-weight: 950;
  text-align:center;
}

.settings{ padding: 14px; }
.settingsTitle{ font-weight: 950; letter-spacing:-.2px; margin-bottom: 10px; }
.settingRow{ display:flex; align-items:center; justify-content:space-between; gap: 12px; padding: 8px 0; }
.settingName{ font-weight: 900; }
.settingDesc{ font-size:12px; color: var(--muted); margin-top: 3px; }
.settingText{ min-width: 0; }

/* iOS-like switch */
.switch{
  width: 46px;
  height: 28px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
  position: relative;
}
html[data-theme="dark"] .switch{ background: rgba(255,255,255,.06); }
.switch .knob{
  position:absolute;
  top:3px;
  left:3px;
  width:22px;
  height:22px;
  border-radius: 999px;
  background: rgba(255,255,255,.96);
  box-shadow: 0 8px 16px rgba(0,0,0,.12);
  transition: transform .18s cubic-bezier(.2,.9,.2,1);
}
.switch[aria-checked="true"]{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.switch[aria-checked="true"] .knob{ transform: translateX(18px); }

/* THEME SWITCH (солнце/луна) — без подсветки "вкл" */
.themeSwitch{
  position: relative;
  width: 92px;
  height: 38px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.18);
  overflow: hidden;
}
html[data-theme="dark"] .themeSwitch{
  background: rgba(255,255,255,.06);
}

/* Ползунок (круг) */
.themeKnob{
  position:absolute;
  top: 3px;
  left: 3px;
  width: 32px;
  height: 32px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.35);

  display: grid;
  place-items: center;

  transition: transform .18s ease;
}
html[data-theme="dark"] .themeKnob{
  background: rgba(255,255,255,.12);
}

/* Сдвиг ползунка вправо (тёмная тема = aria-checked="true") */
.themeSwitch[aria-checked="true"] .themeKnob{
  transform: translateX(54px);
}

/* Иконки живут ВНУТРИ ползунка */
.themeKnob .themeIcon{
  position: absolute;
  font-size: 14px;  /* меньше */
  line-height: 1;
  opacity: 0;       /* по умолчанию невидимы */
  transition: opacity .12s ease;
}

/* В светлой теме показываем солнце */
html[data-theme="light"] .themeKnob .sun{
  opacity: 1;
}

/* В тёмной теме показываем луну */
html[data-theme="dark"] .themeKnob .moon{
  opacity: 1;
}

.supportBtn:active{ transform: scale(.99); }

/* Увеличенный заголовок внутри модалки (только там, где явно задан класс) */
.modalHBig{ font-size: 22px; }

/* Чуть воздуха над нижними вкладками на странице профиля */
.page[data-page="profile"] .supportBtn{ margin-bottom: 10px; }

/* TABBAR */
.tabbar{
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  width: min(560px, calc(100vw - (var(--pad) * 2)));
  bottom: calc(var(--pad) + var(--safeBot));
  height: var(--tabH);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 10px;
  gap: 8px;
  z-index: 60;
}
.tab{
  flex:1;
  height: 56px;
  border-radius: 18px;
  border: 1px solid transparent;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap: 4px;
  opacity: .85;
  transition: transform .12s ease, opacity .12s ease;
}
.tab:active{ transform: scale(.98); }
.tab .tTxt{ font-size: 11px; }
.tab.active{
  opacity: 1;
  border-color: var(--accentBorder);
  background: var(--accentBg);
}

/* --------- Page transitions --------- */
.page{opacity:0; transform: translateY(8px); transition: opacity 260ms cubic-bezier(0.25,1,0.33,1), transform 260ms cubic-bezier(0.25,1,0.33,1);}
.page[hidden]{display:none !important;}
.page.pageActive{opacity:1; transform: translateY(0);} 

/* --------- Modal transitions --------- */
.modal{display:none;}
.modal.show{display:block;}
.modal .modalCard{
  opacity:0;
  transform: translate(-50%, -50%) scale(.98);
  transition: opacity 220ms cubic-bezier(0.25,1,0.33,1), transform 220ms cubic-bezier(0.25,1,0.33,1);
}
.modal.show .modalCard{
  opacity:1;
  transform: translate(-50%, -50%) scale(1);
}


/* --------- Reveal on scroll --------- */
.reveal, [data-reveal]{opacity:0; transform: translateY(12px); transition: opacity 600ms cubic-bezier(0.25,1,0.33,1), transform 600ms cubic-bezier(0.25,1,0.33,1);}
.reveal.is-revealed, [data-reveal].is-revealed{opacity:1; transform: translateY(0);} 

/* reveal directions (как у home кнопок: выезд с разных сторон) */
[data-reveal="left"]{ transform: translateX(-14px); }
[data-reveal="right"]{ transform: translateX(14px); }
[data-reveal="up"]{ transform: translateY(16px); }
[data-reveal="down"]{ transform: translateY(-16px); }
[data-reveal="left"].is-revealed,
[data-reveal="right"].is-revealed,
[data-reveal="up"].is-revealed,
[data-reveal="down"].is-revealed{ transform: translate3d(0,0,0); }

/* Tap scale (cards/buttons) */
.svcCard:active, .tile:active, .cta:active{transform: scale(.98);} 

/* --------- Home layout --------- */
.homeProfile{margin-bottom:14px;}
.profileTopLine{display:flex; align-items:center; justify-content:space-between; gap:10px;}
.iconBtn{width:38px; height:38px; border-radius:14px; border:1px solid var(--hair); background: rgba(255,255,255,.6); display:flex; align-items:center; justify-content:center;}
html[data-theme="dark"] .iconBtn{background: rgba(15,17,21,.55);} 
.homeCtas{display:flex; flex-direction:column; gap:12px; margin-top:12px;}
.cta.secondary{background: rgba(255,255,255,.55); border:1px solid var(--hair);} 
html[data-theme="dark"] .cta.secondary{background: rgba(15,17,21,.55);} 
.profileQuickBtns{display:flex; gap:10px; margin-top:10px;}
.profileQuickBtns .supportBtn{flex:1; height:48px; display:flex; align-items:center; justify-content:center;}

/* --------- Services --------- */
.servicesSeg{margin-top:10px;}
.servicesHero{padding:14px; margin-top:12px;}
.servicesHeroTitle{font-weight:700; font-size:18px;}
.servicesHeroSub{opacity:.75; margin-top:4px;}
.servicesGrid{display:flex; flex-direction:column; gap:10px; margin-top:12px;}
.svcSection{
  padding: 10px 12px;
  border-radius: 18px;
  border: 1px dashed var(--hair);
  background: rgba(255,255,255,.24);
}
html[data-theme="dark"] .svcSection{ background: rgba(255,255,255,.06); }
.svcSectionTitle{ font-weight: 950; letter-spacing:-.2px; }
.svcSectionSub{ opacity:.75; margin-top:4px; font-size:13px; }
.svcNote{ opacity:.75; font-size:13px; margin-top:2px; }
.svcCard{display:flex; gap:12px; align-items:flex-start; padding:12px; border-radius:18px;}
.svcIco{width:42px; height:42px; border-radius:16px; display:flex; align-items:center; justify-content:center; background: rgba(215,255,0,.18);} 
.svcBody{flex:1; min-width:0;}
.svcTitle{font-weight:700; line-height:1.2;}
.svcSub{opacity:.7; font-size:13px; margin-top:2px;}
.svcMeta{display:flex; flex-direction:column; gap:8px; align-items:flex-end;}
.svcPrice{font-weight:700; font-size:13px; opacity:.9;}

/* --------- About --------- */
.aboutCard{padding:14px; margin-top:12px;}
.aboutTitle{font-weight:800; font-size:18px;}
.aboutText{opacity:.8; margin-top:6px;}

/* About tabs: отдельные кнопки (без общего контейнера) */
.aboutTabs{
  display:flex;
  gap: 10px;
  padding: 0 14px;
  margin-top: 12px;
}
.aboutTabs .segBtn{
  border-radius: 18px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.35);
}
html[data-theme="dark"] .aboutTabs .segBtn{ background: rgba(255,255,255,.06); }
.acc{display:flex; flex-direction:column; gap:8px; margin-top:10px;}
.accItem{border:1px solid var(--hair); border-radius:16px; overflow:hidden; background: rgba(255,255,255,.5);} 
html[data-theme="dark"] .accItem{background: rgba(15,17,21,.55);} 
.accHead{width:100%; display:flex; align-items:center; justify-content:space-between; padding:12px 12px; background: transparent; border:0; font-weight:600;}
.accIco{transition: transform 220ms cubic-bezier(0.25,1,0.33,1); opacity:.7;}
.accBody{max-height:0; overflow:hidden; opacity:0; padding:0 12px; transition: max-height 260ms cubic-bezier(0.25,1,0.33,1), opacity 200ms ease;}
.accItem.open .accBody{max-height:140px; opacity:1; padding:0 12px 12px;}
.accItem.open .accIco{transform: rotate(180deg);} 

.reviewsTrack{display:flex; gap:12px; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; padding:12px 2px 6px;}
.reviewSlide{flex:0 0 86%; scroll-snap-align:center; border:1px dashed var(--hair); border-radius:18px; min-height:130px; display:flex; align-items:center; justify-content:center; opacity:.85;}
.dots{display:flex; gap:6px; justify-content:center; padding:8px 0 2px;}
.dot{width:6px; height:6px; border-radius:999px; background: rgba(0,0,0,.25);} 
html[data-theme="dark"] .dot{background: rgba(255,255,255,.25);} 
.dot.active{background: var(--lime);} 

.story{margin-top:12px;}
.storySection{height:140vh;}
.storySticky{position:sticky; top:12px; padding:14px;}
.storyTitle{font-weight:800; font-size:18px;}
.storyGrid{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;}
.storyImg{border-radius:16px; border:1px dashed var(--hair); min-height:140px; display:flex; align-items:center; justify-content:center;}
.storySub{opacity:.7; margin-top:10px; font-size:13px;}

/* ====== BEFORE/AFTER placeholders (10 cases) ====== */
.baStory{margin-top:12px;}
.baSection{height:160vh;}
.baSticky{position:sticky; top:12px;}
.baPair{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
@media (max-width:420px){
  .baPair{grid-template-columns:1fr;}
}
.baPh{
  border-radius: 18px;
  border: 1px dashed var(--hair);
  min-height: 220px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  letter-spacing: .22em;
  text-indent: .22em;
  opacity:.92;
  will-change: transform, opacity;
  transform: translate3d(0,0,0);
  background: rgba(255,255,255,.35);
}
html[data-theme="dark"] .baPh{ background: rgba(15,17,21,.55); }
.baPh span{font-size:20px; opacity:.78;}

/* entrance from edges */
.baBefore{ transform: translate3d(-16vw,0,0); opacity:0; }
.baAfter { transform: translate3d( 16vw,0,0); opacity:0; }
.baSection.baActive .baBefore,
.baSection.baActive .baAfter{ transform: translate3d(0,0,0); opacity:1; transition: transform 680ms cubic-bezier(0.25,1,0.33,1), opacity 520ms cubic-bezier(0.25,1,0.33,1); }

/* --------- Map modal --------- */
.modalCardWide{width: min(520px, calc(100vw - 28px));}
.mapFrameWrap{margin-top:10px; border-radius:18px; overflow:hidden; border:1px solid var(--hair);}
.mapFrameWrap iframe{width:100%; height:280px; border:0;}
.mapMeta{margin-top:10px;}
.mapLine{font-weight:600;}
.mapLine.hint{opacity:.7; font-weight:400; margin-top:2px;}
.mapBtns{display:flex; gap:10px; margin-top:10px;}

/* Saved addresses */
.crSavedList{display:flex; flex-direction:column; gap:10px;}
.crSavedRow{display:flex; gap:10px; align-items:stretch;}
.crSavedPick{flex:1; min-width:0; justify-content:flex-start; text-align:left;}
.crSavedDel{
  width:42px;
  border-radius: 14px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.35);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:16px;
}
html[data-theme="dark"] .crSavedDel{ background: rgba(15,17,21,.55); }
.crSavedDel:active{ transform: scale(.98); }

/* CHAT */
.chatFab{
  position: fixed;
  right: 18px;
  bottom: calc(var(--pad) + var(--tabH) + 18px + var(--safeBot));
  width: 56px;
  height: 56px;
  border-radius: 20px;
  background: linear-gradient(180deg, var(--lime), var(--lime2));
  color:#0f1115;
  font-size: 20px;
  box-shadow: 0 18px 42px rgba(215,255,0,.22);
  z-index: 70;
  display:flex; align-items:center; justify-content:center;
}
.chatFab:active{ transform: scale(.95); }
.chatFab.flash{ animation: flashPulse .6s ease; }
@keyframes flashPulse{
  0%{ transform: scale(1); box-shadow: 0 18px 42px rgba(215,255,0,.22); }
  50%{ transform: scale(1.06); box-shadow: 0 22px 60px rgba(215,255,0,.35); }
  100%{ transform: scale(1); box-shadow: 0 18px 42px rgba(215,255,0,.22); }
}
.chatFabDot{
  position:absolute;
  top:10px; right:10px;
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: #ff3b30;
  box-shadow: 0 0 0 6px rgba(255,59,48,.18);
}

.chat{ position: fixed; inset: 0; display:none; z-index: 90; }
.chat.show{ display:block; }
.chatBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}

/* чат НЕ прозрачный */
.chatPanel{
  position:absolute;
  right: 14px;
  bottom: calc(var(--pad) + var(--tabH) + 18px + var(--safeBot));
  width: min(380px, calc(100vw - 28px));
  height: min(560px, calc(var(--vh) - 200px));
  border-radius: 26px;
  overflow:hidden;

  background: var(--bg1);
  border: 1px solid var(--hair);
  box-shadow: var(--shadow);
}
html[data-theme="dark"] .chatPanel{ background: #0f1115; }

.chatHead{
  display:flex; align-items:center; justify-content:space-between;
  padding: 12px;
  border-bottom: 1px solid var(--hair);
}
.chatClose{
  width: 38px; height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.30);
}
html[data-theme="dark"] .chatClose{ background: rgba(255,255,255,.06); }
.chatTitle{ font-weight: 950; }
.chatSub{ margin-top:2px; font-size: 12px; color: var(--muted); }

.chatBody{
  overflow:auto;
  padding: 12px;
  height: calc(100% - 56px - 70px); /* фикс обрезания: резерв под форму */
  display:flex;
  flex-direction:column;
  gap: 10px;
}

.bubble{
  max-width: 88%;
  padding: 10px 12px;
  border-radius: 18px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.22);
  font-size: 13px;
  line-height: 1.3;
}
html[data-theme="dark"] .bubble{ background: rgba(255,255,255,.06); }
.bubble.bot{ align-self:flex-start; }
.bubble.me{
  align-self:flex-end;
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.18), rgba(215,255,0,.06));
}

.chatForm{
  position:absolute;
  left:0; right:0; bottom:0;
  padding: 12px;
  padding-bottom: calc(12px + var(--safeBot));
  display:flex;
  gap: 10px;
  border-top: 1px solid var(--hair);
  background: var(--bg1);
}
html[data-theme="dark"] .chatForm{ background: #0f1115; }

.chatInput{
  flex:1;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  outline:none;
}
html[data-theme="dark"] .chatInput{ background: rgba(255,255,255,.06); }
.chatSend{
  width: 46px;
  border-radius: 16px;
  border: 1px solid color-mix(in oklab, var(--lime) 55%, var(--hair));
  border-color: var(--accentBorder);
  background: var(--accentBg);
  font-weight: 950;
}
.chatSend:active{ transform: scale(.96); }

/* MODAL (center, opaque) */
.modal{ position: fixed; inset:0; display:none; z-index: 100; }
.modal.show{ display:block; }
.modalBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}
.modalCard{
  position:absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(520px, calc(100vw - 28px));
  max-height: min(640px, calc(var(--vh) - 120px));
  overflow:auto;

  border-radius: 26px;
  padding: 16px;

  background: var(--bg1);
  border: 1px solid var(--hair);
  box-shadow: var(--shadow);
}
html[data-theme="dark"] .modalCard{ background:#0f1115; }

.modalClose{
  position:absolute;
  top:10px;
  right:10px;
  width: 38px;
  height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
}
html[data-theme="dark"] .modalClose{ background: rgba(255,255,255,.06); }

.modalH{ font-weight: 950; font-size: 16px; letter-spacing:-.2px; margin:2px 0 6px; }
.modalP{ font-size: 13px; color: var(--muted); margin:0 0 10px; }
.modalGrid{ display:flex; flex-direction:column; gap: 10px; }
.modalRow{ display:flex; justify-content:space-between; gap: 10px; font-size: 13px; }
.modalRow span{ color: var(--muted); }

.modalRowCol span{ color: var(--muted); display:block; margin-bottom:8px; }

/* ---------------- REGISTRATION / PROFILE EDIT ---------------- */
.modalLock .modalBackdrop{ pointer-events:none; }

.seg{ display:flex; gap:8px; }
.segBtn{
  flex:1;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: var(--txt);
  border-radius: 14px;
  padding: 10px 12px;
  font-weight: 800;
  font-size: 13px;
}
html[data-theme="light"] .segBtn{ border-color: rgba(0,0,0,.08); background: rgba(0,0,0,.03); }
.segBtn.active{
  outline: none;
  border-color: var(--accentBorder);
  background: var(--accentBg);
}
html[data-theme="light"] .segBtn.active{ background: var(--accentBg); }

.avatarPick{ display:grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
.avatarOpt{
  width: 100%;
  aspect-ratio: 1/1;
  border-radius: 16px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}
html[data-theme="light"] .avatarOpt{ border-color: rgba(0,0,0,.08); background: rgba(0,0,0,.03); }
.avatarOpt img{ width:100%; height:100%; object-fit:cover; display:block; }
.avatarOpt.active{ outline: 2px solid rgba(255,255,255,.24); }
html[data-theme="light"] .avatarOpt.active{ outline: 2px solid rgba(0,0,0,.12); }

.avatarUploadRow{ display:flex; align-items:center; gap: 10px; }
.avatarHint{ font-size: 12px; color: var(--muted); }

.formError{
  font-size: 13px;
  color: #ff8c8c;
  background: rgba(255, 80, 80, .10);
  border: 1px solid rgba(255, 80, 80, .25);
  padding: 10px 12px;
  border-radius: 14px;
}

.giftCode{
  font-weight: 950;
  letter-spacing: .6px;
  text-transform: uppercase;
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px dashed rgba(255,255,255,.22);
  text-align:center;
}
html[data-theme="light"] .giftCode{ border-color: rgba(0,0,0,.18); }
.phoneRow{ display:flex; gap:10px; align-items:center; }
.phoneInput{
  flex:1;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  outline:none;
}
html[data-theme="dark"] .phoneInput{ background: rgba(255,255,255,.06); }

.smallBtn{
  padding: 10px 12px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.22);
  font-weight: 950;
}
html[data-theme="dark"] .smallBtn{ background: rgba(255,255,255,.06); }
.smallBtn.primary{
  border-color: color-mix(in oklab, var(--lime) 55%, var(--hair));
  background: linear-gradient(180deg, rgba(215,255,0,.26), rgba(215,255,0,.10));
}
.smallBtn:active{ transform: scale(.98); }

/* disabled-state (используем для регистрации) */
.smallBtn:disabled{
  opacity: .55;
  pointer-events: none;
}

/* Кнопка "Завершить регистрацию" — компактная и по центру */
#regSubmitBtn{
  align-self: center;
  width: auto;
  padding-left: 14px;
  padding-right: 14px;
}

.smallBtn.danger{
  border-color: rgba(255,59,48,.42);
  background: linear-gradient(180deg, rgba(255,80,80,.18), rgba(255,80,80,.08));
}

.rateStars{
  display:flex;
  gap: 10px;
  justify-content:center;
  margin-top: 8px;
}
.rateStar{
  width: 44px;
  height: 44px;
  border-radius: 16px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.22);
  font-size: 20px;
  line-height: 1;
  padding:0;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity: .65;
}
html[data-theme="dark"] .rateStar{ background: rgba(255,255,255,.06); }
.rateStar.on{ opacity: 1; }

/* SHEETS */
.sheet{ position: fixed; inset:0; display:none; z-index: 110; }
.sheet.show{ display:block; }
.sheetBackdrop{
  position:absolute; inset:0;
  background: rgba(0,0,0,.35);
}
.sheetCard{
  position:absolute;
  left: var(--pad);
  right: var(--pad);
  bottom: calc(var(--pad) + var(--safeBot));
  border-radius: 26px;
  overflow:hidden;

  background: var(--bg1);
  border: 1px solid var(--hair);
  box-shadow: var(--shadow);
}
html[data-theme="dark"] .sheetCard{ background:#0f1115; }

.sheetHead{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 10px;
  padding: 14px;
  border-bottom: 1px solid var(--hair);
}
.sheetTitle{ font-weight: 950; }
.sheetSub{ margin-top:3px; font-size: 12px; color: var(--muted); }
.sheetClose{
  width: 38px; height: 38px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
}
html[data-theme="dark"] .sheetClose{ background: rgba(255,255,255,.06); }

.sheetBody{
  padding: 14px;
  display:flex;
  flex-direction:column;
  gap: 12px;
}

.fieldLabel{ font-size: 12px; color: var(--muted); margin-bottom: 6px; }

/* Form spacing: label + input breathe and never stick together */
.field{ display:block; margin-top: 12px; min-width:0; }
.field:first-child{ margin-top: 0; }
.fieldHint{
  font-size: 12px;
  color: var(--muted);
  opacity: .9;
  margin: -2px 0 8px;
  line-height: 1.25;
}

/* заметка в шторке (оценка по фото) */
.sheetNote{
  padding: 12px;
  margin-bottom: 12px;
}
.sheetNoteTitle{
  font-weight: 700;
  font-size: 13px;
  margin-bottom: 6px;
}
.sheetNoteText{
  font-size: 13px;
  line-height: 1.25;
}

/* предпросмотр заявки */
.estimatePreview{
  padding: 12px;
  margin: 12px 0;
}
.estimatePreviewTitle{
  font-weight: 700;
  font-size: 13px;
  margin-bottom: 8px;
}
.estimatePreviewRow{
  font-size: 13px;
  line-height: 1.25;
  margin: 4px 0;
}
.fieldInput, .fieldSelect{
  width: 100%;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  outline:none;
}
html[data-theme="dark"] .fieldInput,
html[data-theme="dark"] .fieldSelect{ background: rgba(255,255,255,.06); }

.sheetBtn{ justify-content:center; }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{ transition:none !important; animation:none !important; }
}

/* ====== ESTIMATE FLOW ====== */
.cta[disabled]{ opacity:.45; pointer-events:none; transform:none !important; }

/* ====== COURIER FLOW (local tweaks, НЕ трогаем общий визуал) ====== */
section.page[data-page="courier"] .fieldInput,
section.page[data-page="courier"] .fieldSelect{
  padding: 14px 14px;
  font-size: 16px;
  line-height: 1.25;
  box-sizing: border-box;
  max-width: 100%;
}
section.page[data-page="courier"] .fieldLabel{ font-size: 13px; }
section.page[data-page="courier"] .orderLine{ font-size: 14px; }
section.page[data-page="courier"] .field{ min-width: 0; }

#estimateOtherWrap{
  max-height: 0;
  opacity: 0;
  transform: translateY(-6px);
  overflow: hidden;
  transition: max-height .24s ease, opacity .24s ease, transform .24s ease;
}
#estimateOtherWrap.show{
  max-height: 260px;
  opacity: 1;
  transform: translateY(0);
}

.estimateAbout{ padding:12px; }
.estimateAboutTitle{ font-weight:900; font-size:13px; margin-bottom:6px; }
.estimateAboutText{ font-size:13px; line-height:1.25; }

.globalLoading{
  position: fixed;
  inset: 0;
  display: none;
  align-items:center;
  justify-content:center;
  z-index: 9999;
  background: rgba(0,0,0,.35);
  backdrop-filter: blur(4px);
}
.globalLoading.show{ display:flex; }
.globalLoadingCard{ padding:14px 16px; border-radius:18px; display:flex; gap:12px; align-items:center; }
.spinner{
  width:22px; height:22px; border-radius:50%;
  border:3px solid rgba(255,255,255,.35);
  border-top-color: rgba(255,255,255,.95);
  animation: spin .85s linear infinite;
}
@keyframes spin{ to{ transform: rotate(360deg);} }
.globalLoadingText{ font-size:13px; font-weight:800; }

/* Оценка по фото — отступ перед кнопкой и центр кнопки */
#estimateNextBtn{
  display: block;
  margin: 18px auto 0;      /* отступ сверху + центр */
  width: min(320px, 100%);  /* не во всю ширину, но адаптивно */
}

/* ===== Estimate page: STANDARD like other pages ===== */
.page[data-page="estimate"] .pageHead{
  display:flex;
  gap: 12px;
  align-items:flex-start;
  justify-content:flex-start;
  margin-bottom: 0;
}

.page[data-page="estimate"] .pageTitle{
  font-weight: 950;
  font-size: 18px;        /* как у других страниц */
  letter-spacing:-.2px;
  text-align: left;
}

.page[data-page="estimate"] .pageSub{
  margin-top:2px;
  font-size: 12px;        /* как у других страниц */
  color: var(--muted);
  text-align: left;
}

.page[data-page="estimate"] .estimateCard{
  padding: 14px;
  border-radius: 22px;
}

#estimateOtherWrap{
  margin-top: 10px;
}

/* На странице оценки скрываем табы и чат */
body.page-estimate .tabbar,
body.page-estimate #chatFab{
  display: none !important;
}

/* Модалка отправки фото — чуть больше и больше воздуха сверху */
#estimateSendModal .modalCard{
  width: min(420px, calc(100% - 28px));
  padding-top: 22px; /* крестик остаётся там же, но текст ниже — не липнет */
}

#estimateSendModal .modalH{
  margin-top: 6px;
}

.page[data-page="estimate"] .estimateCard{
  padding: 14px;
  border-radius: 22px;
}

/* отступ между появляющимся полем и следующим полем */
#estimateOtherWrap.show{
  margin-bottom: 12px;
}

#leaveEstimateModal .modalCard{
  width: min(440px, calc(100vw - 28px));
  padding-top: 22px; /* чтобы крестик не касался текста */
}
#leaveEstimateModal .modalH{ margin-top: 6px; }

.pulseDot{
  width:18px;
  height:18px;
  border-radius:999px;
  background:#34c759;
  box-shadow: 0 0 0 0 rgba(52,199,89,.25);
  animation: pulseSoft 1.6s ease-in-out infinite;

  display:flex;
  align-items:center;
  justify-content:center;
  position: relative;
}

/* слабая пульсация (по умолчанию) */
@keyframes pulseSoft{
  0%{ box-shadow: 0 0 0 0 rgba(52,199,89,.22); transform: scale(1); }
  70%{ box-shadow: 0 0 0 7px rgba(52,199,89,0); transform: scale(1.04); }
  100%{ box-shadow: 0 0 0 0 rgba(52,199,89,0); transform: scale(1); }
}

/* усиленная пульсация + синий цвет когда есть непрочитанные */
.pulseDot.hasUnread{
  background:#2f80ed;
  box-shadow: 0 0 0 0 rgba(47,128,237,.40);
  animation: pulseStrong 1.1s ease-in-out infinite;
}

@keyframes pulseStrong{
  0%{ box-shadow: 0 0 0 0 rgba(47,128,237,.45); transform: scale(1); }
  70%{ box-shadow: 0 0 0 11px rgba(47,128,237,0); transform: scale(1.08); }
  100%{ box-shadow: 0 0 0 0 rgba(47,128,237,0); transform: scale(1); }
}

/* цифра непрочитанных внутри зелёной точки */
.pulseNum{
  font-size: 11px;
  font-weight: 900;
  line-height: 1;
  color: rgba(8,12,8,.92);
  text-shadow: 0 1px 1px rgba(255,255,255,.25);
}

.pulseDot.hasUnread .pulseNum{
  color: rgba(255,255,255,.95);
  text-shadow: 0 1px 2px rgba(0,0,0,.35);
}

/* ---- PHOTO ESTIMATES TILE STATES ---- */

#photoEstimatesTile.peBlue,
#photoEstimatesTile.peGreen{
  border-color: var(--hair);
}

/* карточка заявки в списке */
.peItem{
  padding: 14px;
  display:flex;
  flex-direction:column;
  gap: 10px;
}
.peTop{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 10px;
}
.peTitle{ font-weight: 950; letter-spacing:-.2px; }
.peMeta{ margin-top:3px; font-size: 12px; color: var(--muted); }

.peStatus{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 6px 10px;
  border-radius: 999px;
  border:1px solid var(--hair);
  background: rgba(255,255,255,.30);
  font-size: 12px;
  font-weight: 900;
}
html[data-theme="dark"] .peStatus{ background: rgba(255,255,255,.06); }

.peDot{ width:8px; height:8px; border-radius:999px; background:#ff9f0a; }
.peDot.waiting_media{ background:#ff9f0a; }
.peDot.waiting_admin{ background:#ff9f0a; }
.peDot.answered{ background:#34c759; }
.peDot.archived{ background: rgba(255,255,255,.55); }

.peBody{ font-size: 13px; color: var(--muted); line-height:1.25; }

/* --- PHOTO ESTIMATES CARD (modal) --- */
.peInfo .peInfoRow{
  font-size: 15px;
}
.peInfo .peInfoRow span{ font-size: 13px; }
.peInfo .peInfoRow b{ font-weight: 950; }

.peReplyBox{
  margin-top: 12px;
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--hair);
  background: rgba(255,255,255,.22);
  text-align: center;
}
html[data-theme="dark"] .peReplyBox{ background: rgba(255,255,255,.06); }
.peReplyTitle{ font-weight: 950; margin-bottom: 8px; }
.peReplyText{
  font-size: 13px;
  color: var(--txt);
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
}

.peActions{
  margin-top: 12px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
.peActions .danger{ grid-column: 1 / -1; }

/* --- Registration title --- */
.modalTitleReg{
  font-size: 22px;
  font-weight: 700;
  text-align: center;
}

/* --- TG icon button (phone) --- */
.tgIconBtn{
  display:flex;
  align-items:center;
  justify-content:center;
  width:40px;
  height:40px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  /* Цвет иконки должен зависеть от темы */
  color: var(--txt);
}
.tgIconBtn svg{ opacity:.9; }
.tgIconBtn svg path{ fill: currentColor; }

/* City/Gender active now use the same unified active style as everywhere (.segBtn.active). */

/* Generic unified active style (for any tappable UI state) */
.is-active{
  border-color: var(--accentBorder) !important;
  background: var(--accentBg) !important;
}

/* About top tabs: buttons are standalone (no shared glass container) */
.aboutTabs{ display:flex; gap:10px; padding: 0 var(--pad); margin-top: 10px; }
.aboutTabs .segBtn{ border-radius: 18px; border:1px solid var(--hair); background: rgba(255,255,255,.30); }
html[data-theme="dark"] .aboutTabs .segBtn{ background: rgba(255,255,255,.06); }

/* Center loader (used e.g. for Before/After image loading) */
.centerLoader{
  position: fixed;
  inset: 0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index: 120;
  background: rgba(0,0,0,.08);
  backdrop-filter: blur(6px);
}
html[data-theme="dark"] .centerLoader{ background: rgba(0,0,0,.25); }
.centerLoader.show{ display:flex; }
.loaderPill{
  padding: 10px 14px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  background: var(--glass);
  box-shadow: var(--shadow);
  font-weight: 900;
}

/* --- Registration submit: компактная кнопка по ширине текста и по центру --- */
#regSubmitBtn{
  align-self: center;
  width: auto;
  padding-left: 14px;
  padding-right: 14px;
}

/* --- Disabled buttons (регистрация неактивна, пока всё не заполнено) --- */
.smallBtn:disabled,
.cta:disabled{
  opacity: .55;
  pointer-events: none;
}

/* --- Field errors --- */
.inputError{
  border-color: rgba(255,59,48,.85) !important;
  box-shadow: 0 0 0 2px rgba(255,59,48,.25);
}
.segError{
  border-color: rgba(255,59,48,.85) !important;
  box-shadow: 0 0 0 2px rgba(255,59,48,.25);
}

/* --- Hint under phone --- */
.phoneHint{
  margin-top:6px;
  font-size:12px;
  opacity:.75;
  line-height:1.25;
}

#photoRequestsBtn{
  display:none;
  position: relative;
}

#photoRequestsBtn.green{
  background: #2ecc71;
}

#photoRequestsBtn.blue{
  background: #3498db;
}

#photoRequestsBtn.blink{
  animation: pulse 1.2s infinite;
}

@keyframes pulse{
  0%{ box-shadow: 0 0 0 0 rgba(46,204,113,.6); }
  100%{ box-shadow: 0 0 0 12px rgba(46,204,113,0); }
}

#photoRequestsBtn .badge{
  position:absolute;
  top:-6px;
  right:-6px;
  background:#fff;
  color:#3498db;
  border-radius:50%;
  font-size:12px;
  padding:2px 6px;
  font-weight:600;
}


/* --- Iteration 4 UX tweaks (minimal, local) --- */
.settingRowCenter{justify-content:center;}
.settingRowCenter .profileBtn{width:100%; max-width:360px; margin:0 auto;}

/* Profile card prettier (no color changes) */
.profileRow{gap:12px;}
.profileName{font-size:18px; line-height:22px;}
.profileHint{font-size:13px;}
.profileQuickBtns{display:flex; gap:12px; margin-top:10px;}
.profileQuickBtns .supportBtn{flex:1; justify-content:center;}

/* Courier wizard form polish (only inside courier page) */
[data-page="courier"] .estimateCard{padding:14px;}
[data-page="courier"] .fieldLabel{font-size:13px; margin-bottom:6px;}
[data-page="courier"] .fieldInput,
[data-page="courier"] .fieldSelect{font-size:16px; padding:12px 12px;}
[data-page="courier"] .order{border-radius:18px;}
[data-page="courier"] .orderTop{align-items:center;}
[data-page="courier"] .orderId{font-size:14px; opacity:.9;}
[data-page="courier"] .crItemCard{margin-top:10px;}
[data-page="courier"] .crItemCard:first-child{margin-top:0;}
[data-page="courier"] .crItemTitle{font-size:13px; margin-left:2px;}

/* Fix mobile overflow for date/time rows */
[data-page="courier"] .modalGrid{grid-template-columns:1fr; gap:10px;}
[data-page="courier"] input[type="date"],
[data-page="courier"] input[type="time"]{width:100%; box-sizing:border-box;}

/* Inline errors */
.crErr{font-size:14px; margin-top:8px; font-weight:600;}


/* --- Courier wizard (new screens only) --- */
.page[data-page="courier"] .estimateCard{padding:14px;}
.page[data-page="courier"] .fieldInput,
.page[data-page="courier"] .fieldSelect{width:100%; box-sizing:border-box;}
.crSectionTitle{font-size:18px; font-weight:800; margin-bottom:6px;}
.crSectionSub{font-size:14px; color:var(--muted); margin-bottom:12px;}
.crItemsList{display:flex; flex-direction:column; gap:10px;}
.crItemCard{padding:12px;}
.crItemHead{display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px;}
.crItemTitle{font-size:14px; font-weight:700;}
.crActionsRow{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px;}
@media (max-width:420px){
  .crActionsRow{grid-template-columns:1fr;}
}
.crFormGrid{display:flex; flex-direction:column; gap:12px;}
.crRow2{display:grid; grid-template-columns:1fr 1fr; gap:10px;}
@media (max-width:420px){
  .crRow2{grid-template-columns:1fr;}
}
.crErr{color:var(--danger,#ff3b30); font-size:15px; font-weight:700; margin-top:8px;}
.crPreview{padding:12px; border-radius:14px;}
.crPreviewRow{display:flex; align-items:baseline; justify-content:space-between; gap:10px; padding:6px 0;}
.crPreviewKey{opacity:.75; font-weight:700;}
.crPreviewVal{min-width:0; text-align:right;}
.crPreviewVal b{font-weight:800;}
.crPreviewLine{margin:6px 0;}
.crPreviewItems{margin-top:10px; display:flex; flex-direction:column; gap:10px;}
.crBadgeReq{font-weight:800;}
.crSavedAddrs{display:flex; flex-wrap:wrap; gap:8px; margin-top:8px;}
.crSavedAddrs .smallBtn{white-space:nowrap;}



/* ====== PATCH 2026-01-21: Home/Profile layout + theme toggle ====== */
.topbar{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:12px;
}
.themeSwitch{
  width: 92px;
  height: 38px;
  border-radius: 999px;
  border: 1px solid var(--hair);
  position: relative;
  flex: 0 0 auto;
}

/* Profile panel: no avatar */
.profileRowNoAvatar{display:flex; align-items:flex-start;}
.profileRowNoAvatar .profileMeta{width:100%;}
.profileName{line-height:1.15;}

/* ---------------- HOME (profile + CTAs) ---------------- */

.homeProfile{
  position: relative;
  padding: 16px;
}

.profileCorner{
  position:absolute;
  top: 12px;
  right: 12px;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap: 10px;
}

.profileCorner .iconBtn{
  width: 40px;
  height: 40px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  background: color-mix(in oklab, var(--glass) 92%, transparent);
  box-shadow: 0 10px 22px rgba(0,0,0,.08);
}

.themeMini{
  width: 40px;
  height: 40px;
  border-radius: 14px;
  border: 1px solid var(--hair);
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow: 0 10px 22px rgba(0,0,0,.08);
}

.themeMiniIcon{font-size: 18px; line-height: 1;}
html[data-theme="light"] .themeMiniIcon.moon{display:none;}
html[data-theme="dark"] .themeMiniIcon.sun{display:none;}

.profileMetaCentered{
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
  gap: 6px;
  padding-top: 4px;
}

.profileMetaCentered .profileName{
  font-size: 18px;
  font-weight: 900;
  letter-spacing: -.2px;
  margin-top: 2px;
}

.profileQuickBtnsRow{
  width: 100%;
  margin-top: 10px;
  display:flex;
  flex-direction: row-reverse; /* визуально справа-налево */
  justify-content:flex-end;
  gap: 10px;
}

.profileQuickBtnsRow .supportBtn{
  flex: 1;
  height: 46px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight: 850;
}

/* Home CTAs: compact, emoji, smooth slide to center (replays on each home open) */
.homeCtasRow{
  display:flex;
  gap:12px;
  margin-top: 12px;
}

.ctaMini{
  flex:1;
  height: 68px;
  border-radius: 20px;
  border: 1px solid var(--hair);
  background: color-mix(in oklab, var(--glass) 92%, transparent);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap: 6px;
  font-weight: 900;
  letter-spacing: .01em;
  position: relative;
  overflow:hidden;
  will-change: transform, opacity;
  transform: translate3d(0,0,0);
}

.ctaMini::before{
  content:"";
  position:absolute;
  inset:0;
  background: var(--accentBg);
  opacity: .70;
  pointer-events:none;
}

html[data-theme="dark"] .ctaMini::before{ opacity: .52; }

.ctaMini > *{ position: relative; z-index: 1; }
.ctaMini:active{transform: scale(.985);}

.ctaMiniIco{font-size: 20px; line-height: 1;}
.ctaMiniTxt{font-size: 14px;}

/* animation states */
.homeAnim{
  opacity: 0;
  transition: transform 560ms cubic-bezier(0.22,1,0.36,1), opacity 560ms cubic-bezier(0.22,1,0.36,1);
}

.ctaDropoff.homeAnim{ transform: translate3d(-18vw, 0, 0); }
.ctaConsult.homeAnim{ transform: translate3d( 18vw, 0, 0); }
.supportCenter.homeAnim{ transform: translate3d(0, 10px, 0); }

.homeAnim.in{ opacity: 1; transform: translate3d(0,0,0); }

.homeAnim.in{ transition-delay: 40ms; }
.ctaConsult.homeAnim.in{ transition-delay: 90ms; }
.supportCenter.homeAnim.in{ transition-delay: 140ms; }

/* Centered support button */
.supportCenter{
  width: 100%;
  max-width: 360px;
  margin: 14px auto 0;
  display:flex;
  justify-content:center;
}

/* Dropoff modal: center buttons */
.modalActionsCol{
  display:flex;
  flex-direction:column;
  align-items:center;
}
.modalActionsCol .cta{
  width: 100%;
  max-width: 420px;
}


/* =========================
   FIXES (About tabs + Reviews)
   ========================= */

/* 1) About tabs must highlight (same as Services) in BOTH themes */
.segWrap .aboutTabs.seg{
  padding: 0;
  gap: 8px;
}
.segWrap .aboutTabs .segBtn{
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: var(--txt);
}
html[data-theme="light"] .segWrap .aboutTabs .segBtn{
  border-color: rgba(0,0,0,.08);
  background: rgba(0,0,0,.03);
}
.segWrap .aboutTabs .segBtn.active{
  border-color: var(--accentBorder) !important;
  background: var(--accentBg) !important;
}

/* 2) Reviews: full-bleed (edge-to-edge) + smooth snap slider */
.reviewsSection{
  position: relative;
  margin-top: 12px;

  /* FULL BLEED even inside centered .app (push a bit beyond edges on desktop) */
  width: calc(100vw + 64px);
  margin-left: calc(50% - 50vw - 32px);

  border-radius: 0;
  border: 0;

  /* light theme: keep "usual" (transparent like the page) */
  background: transparent;

  /* spacing */
  padding: 12px 0 12px;
  overflow: hidden;
}

/* ONLY this block background in dark theme */
html[data-theme="dark"] .reviewsSection{
  background: #18181a;
}

/* Title like FAQ header (no bubble) */
.reviewsTitle{
  padding: 0 var(--pad);
  font-weight: 800;
  font-size: 18px;
  margin-top: 0;
}

.reviewsSection .reviewsBleed{ margin-top: 10px; }

/* Slider track: smooth, snap, no lag */
.reviewsSection .reviewsTrack{
  display:flex;
  gap: 0;
  overflow-x: auto;
  overscroll-behavior-x: contain;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;

  /* edge-to-edge images */
  padding: 0;
  margin: 0;

  scroll-behavior: smooth;
  scrollbar-width: none; /* Firefox */
  will-change: scroll-position;
}
.reviewsSection .reviewsTrack::-webkit-scrollbar{ display:none; }

/* Each slide takes the full screen width */
.reviewsSection .reviewSlide{
  flex: 0 0 100%;
  width: 100vw;
  scroll-snap-align: start;

  display:flex;
  align-items: flex-start;
  justify-content: stretch;

  border: 0;
  background: transparent;
  border-radius: 0;
}

/* Image: edge-to-edge by width, NO hard crop (top/bottom free) */
.reviewsSection .reviewImg{
  width: 100%;
  height: auto;

  display:block;
  transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-transform: translateZ(0);
}

/* Custom progress "ползунок" (theme-aware) */
.reviewsSection .reviewsProgress{
  margin: 10px var(--pad) 0;
  height: 6px;
  border-radius: 999px;
  background: rgba(15,17,21,.12);
  overflow: hidden;
}
html[data-theme="dark"] .reviewsSection .reviewsProgress{
  background: rgba(243,245,247,.10);
}

.reviewsSection .reviewsProgressFill{
  height: 100%;
  width: 0%;
  border-radius: 999px;
  background: rgba(15,17,21,.38);
  transition: width 80ms linear;
}
html[data-theme="dark"] .reviewsSection .reviewsProgressFill{
  background: rgba(243,245,247,.28);
}

/* Dots stay readable on full-bleed */
.reviewsSection + .dots,
.reviewsSection .dots{
  padding-left: var(--pad);
  padding-right: var(--pad);
}
/* ===== FIX: About tabs active state must match Services in BOTH themes ===== */
.aboutTabs .segBtn.active{
  border-color: var(--accentBorder) !important;
  background: var(--accentBg) !important;
  color: var(--txt) !important;
}
/* Buttons may carry .glass class; ensure it doesn't override active */
.aboutTabs .segBtn.glass.active{
  border-color: var(--accentBorder) !important;
  background: var(--accentBg) !important;
}

/* ===== FIX: Before/After intro overlay should fully cover UI until scroll ===== */
body.ba-mode .baOverlay{ display:flex; }
body.ba-mode:not(.ba-scrolled) #aboutPanelCases .baScroller{ opacity: 0; pointer-events:none; }
body.ba-mode.ba-scrolled #aboutPanelCases .baScroller{ opacity: 1; pointer-events:auto; transition: opacity 220ms ease; }
